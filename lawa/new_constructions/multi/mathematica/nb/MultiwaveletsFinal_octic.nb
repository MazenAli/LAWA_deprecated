(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    252798,       6349]
NotebookOptionsPosition[    251047,       6289]
NotebookOutlinePosition[    251468,       6307]
CellTagsIndexPosition[    251425,       6304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["General Tools", "Section",
 CellChangeTimes->{{3.5146001940064144`*^9, 3.5146001977366276`*^9}, {
  3.514601676054182*^9, 3.5146017025606985`*^9}}],

Cell["\<\
General Polynomial Format {{x^0,x^1,...,x^n},{lower_bound,upper_bound}}, the \
second parenthesis are optional\
\>", "Text",
 CellChangeTimes->{{3.5146050970498524`*^9, 3.514605161542541*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PEvaluate", "[", 
    RowBox[{"list_", ",", "value_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "list", "]"}], ">", "1"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"value", ">=", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
        RowBox[{"value", " ", "<=", " ", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"u", " ", "=", " ", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"u", " ", "=", " ", 
           RowBox[{
            RowBox[{"u", "*", "value"}], "+", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1", 
            ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "u"}], ",", "0"}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{"u", " ", "=", " ", 
       RowBox[{
        RowBox[{"list", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"u", " ", "=", " ", 
         RowBox[{
          RowBox[{"u", "*", "value"}], "+", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "u"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PIntegrate", "[", 
    RowBox[{"polynomial_", ",", "bounds_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "polynomial", "]"}], ">", "1"}], ",", 
        RowBox[{
         RowBox[{"ub", " ", "=", " ", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"polynomial", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"bounds", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"lb", " ", "=", " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"polynomial", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"bounds", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"ub", " ", "=", " ", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
         RowBox[{"lb", "=", " ", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ub", "<", "lb"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"htab", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"1", "/", "i"}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"polynomial", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ";", 
         RowBox[{"sf", " ", "=", " ", 
          RowBox[{
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "htab"}]}], ";", " ", 
         RowBox[{"hlist", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", "sf"}], "]"}]}], ";", "  ", 
         RowBox[{
          RowBox[{"PEvaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hlist", ",", 
              RowBox[{"polynomial", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "ub"}], "]"}], 
          "-", 
          RowBox[{"PEvaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hlist", ",", 
              RowBox[{"polynomial", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "lb"}], 
           "]"}]}]}]}], "]"}]}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PMult", "[", 
    RowBox[{"polynomial1_", ",", "polynomial2_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"polynomial1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[LessEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"polynomial2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"polynomial1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"p2", "=", 
          RowBox[{"polynomial2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"polynomial2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"p2", "=", 
          RowBox[{"polynomial1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "polynomial1", "]"}], ">", "1"}], " ", "&&", 
         " ", 
         RowBox[{
          RowBox[{"Length", "[", "polynomial2", "]"}], ">", "1"}]}], ",", 
        RowBox[{
         RowBox[{"lb", " ", "=", " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"polynomial1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"polynomial2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"ub", " ", "=", " ", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"polynomial1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"polynomial2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], " ", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "polynomial1", "]"}], ">", "1"}], ",", 
          RowBox[{
           RowBox[{"lb", " ", "=", " ", 
            RowBox[{
             RowBox[{"polynomial1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
           RowBox[{"ub", " ", "=", " ", 
            RowBox[{
             RowBox[{"polynomial1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "polynomial2", "]"}], ">", "1"}], ",", 
            RowBox[{
             RowBox[{"lb", " ", "=", " ", 
              RowBox[{
               RowBox[{"polynomial2", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{"ub", "=", 
              RowBox[{
               RowBox[{"polynomial2", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"lb", " ", "=", " ", 
              RowBox[{"-", "Infinity"}]}], ";", " ", 
             RowBox[{"ub", " ", "=", " ", "Infinity"}]}]}], "]"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"lb", " ", "<", "ub"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", " ", "\[LessEqual]", " ", 
               RowBox[{"Length", "[", "p1", "]"}]}], ",", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"p1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1", "-", "j"}], "]"}], "]"}], 
                 RowBox[{"p2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "p1", "]"}], ",", "i"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"p2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", 
                    RowBox[{"Length", "[", "p1", "]"}], "+", "j"}], "]"}], 
                  "]"}], 
                 RowBox[{"p1", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Length", "[", "p1", "]"}], "+", "1", "-", "j"}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "p1", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "p1", "]"}], "+", 
                    RowBox[{"Length", "[", "p2", "]"}], "-", "i"}]}], "]"}]}],
                  "}"}]}], "]"}]}], "]"}], "   ", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "p1", "]"}], "+", 
               RowBox[{"Length", "[", "p2", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"lb", ",", "ub"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddPlists", "[", 
    RowBox[{"list1_", ",", " ", "list2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "list1", "]"}], " ", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "list2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"l1", "=", "list1"}], ";", 
         RowBox[{"l2", "=", "list2"}]}], ",", 
        RowBox[{
         RowBox[{"l2", "=", "list1"}], ";", 
         RowBox[{"l1", "=", "list2"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t\t\t", 
      RowBox[{"erg", " ", "=", " ", "l2"}], ";", " ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"erg", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"erg", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"l1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "l1", "]"}]}], "}"}]}], "]"}], ";", " ", 
      "erg"}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWSimplify", "[", "pw_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"pw", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pw", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">=", 
            RowBox[{
             RowBox[{
              RowBox[{"pw", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "  ", ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"pw", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"pw", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], ">", "0"}], " ", "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PAdd", "[", 
    RowBox[{"polynomial1_", ",", "polynomial2_"}], "]"}], ":=", 
   RowBox[{"PWSimplify", "[", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "polynomial1", "]"}], ">", "1"}], " ", "&&", 
       " ", 
       RowBox[{
        RowBox[{"Length", "[", "polynomial2", "]"}], ">", "1"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"polynomial1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "<=", " ", 
          RowBox[{
           RowBox[{"polynomial2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"polynomial2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "<=", " ", 
          RowBox[{
           RowBox[{"polynomial1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"polynomial1", ",", "polynomial2"}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"polynomial1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", 
            RowBox[{
             RowBox[{"polynomial2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"polynomial1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"polynomial2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"polynomial2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"polynomial2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"polynomial1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AddPlists", "[", 
               RowBox[{
                RowBox[{"polynomial1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"polynomial2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"polynomial1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"polynomial1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"polynomial2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"polynomial1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"polynomial2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"polynomial1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", 
              RowBox[{
               RowBox[{"polynomial2", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"polynomial1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", ">=", " ", 
              RowBox[{
               RowBox[{"polynomial2", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"polynomial1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AddPlists", "[", 
                 RowBox[{
                  RowBox[{"polynomial2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"polynomial1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"polynomial1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"polynomial1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", " ", 
               RowBox[{
                RowBox[{"polynomial2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"polynomial1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"AddPlists", "[", 
                   RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"polynomial2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"polynomial2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"AddPlists", "[", 
                   RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"polynomial1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"polynomial1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], 
               "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"not", " ", "noth", " ", "Length"}], " ", ">", " ", "1"}], 
        "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "polynomial1", "]"}], ">", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"polynomial2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AddPlists", "[", 
             RowBox[{
              RowBox[{"polynomial1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"polynomial2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"polynomial1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "polynomial2", "]"}], ">", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"polynomial1", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AddPlists", "[", 
               RowBox[{
                RowBox[{"polynomial2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"polynomial1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"polynomial2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"AddPlists", "[", 
             RowBox[{
              RowBox[{"polynomial1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"polynomial2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "}"}], "}"}]}], 
         "]"}]}], "]"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalListRemove", "[", 
    RowBox[{"list_", ",", "interval_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"newlist", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"interval", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"interval", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
          RowBox[{"newlist", " ", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newlist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], "]"}]}],
           ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", 
              RowBox[{"interval", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], " ", "||", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "\[LessEqual]", " ", 
              RowBox[{"interval", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"newlist", " ", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"newlist", ",", 
               RowBox[{"{", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">", 
               RowBox[{"interval", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<", " ", 
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"newlist", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"newlist", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"interval", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], 
                  "]"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", 
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"newlist", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"newlist", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"interval", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "}"}]}], 
                  "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Select", "[", 
       RowBox[{"newlist", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}]}], "]"}]}], "}"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWAddP", "[", 
    RowBox[{"polynomial_", ",", "pw_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h1", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"pw", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
             RowBox[{
              RowBox[{"pw", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{"pw", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ">", " ", "0"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "polynomial", "]"}], ">", "1"}], ",", 
        RowBox[{
         RowBox[{"lb", " ", "=", " ", 
          RowBox[{
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"ub", " ", "=", " ", 
          RowBox[{
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"polynomial", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"lb", " ", "=", " ", 
            RowBox[{"-", "Infinity"}]}], ";", " ", 
           RowBox[{"ub", " ", "=", " ", "Infinity"}]}], ",", 
          RowBox[{
           RowBox[{"lb", "=", "0"}], ";", 
           RowBox[{"ub", "=", "0"}], ";"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t", 
      RowBox[{"polysupp", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"lb", ",", "ub"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t", 
      RowBox[{"newpw", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lbt", " ", "=", " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"h1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "lb"}], "]"}]}], ";", 
         RowBox[{"ubt", " ", "=", " ", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"h1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "ub"}], "]"}]}], ";", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"lbt", " ", "<", " ", "ubt"}], ",", 
           RowBox[{
            RowBox[{"newpw", " ", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"newpw", ",", 
               RowBox[{"PAdd", "[", 
                RowBox[{
                 RowBox[{"pw", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"polynomial", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"lbt", ",", "ubt"}], "}"}]}], "}"}]}], "]"}]}], 
              "]"}]}], ";", 
            RowBox[{"polysupp", " ", "=", " ", 
             RowBox[{"IntervalListRemove", "[", 
              RowBox[{"polysupp", ",", 
               RowBox[{"{", 
                RowBox[{"lbt", ",", "ubt"}], "}"}]}], "]"}]}]}], ",", 
           RowBox[{"newpw", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"newpw", ",", 
              RowBox[{"{", 
               RowBox[{"pw", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}]}], "]"}]}], 
        "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "h1", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"newpw", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"newpw", ",", " ", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"polynomial", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"polysupp", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "polysupp", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PWSimplify", "[", "newpw", "]"}]}], "\t\t\t\t", 
     "\[IndentingNewLine]", " ", "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pget", "[", 
   RowBox[{"polynomial_", ",", "symb_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Sum", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"polynomial", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"symb", "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], "  ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"polynomial", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PFactor", "[", 
    RowBox[{"polynomial_", ",", "factor_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "polynomial", "]"}], ">", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"factor", "*", 
          RowBox[{
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "  ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"polynomial", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"polynomial", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"factor", "*", 
         RowBox[{
          RowBox[{"polynomial", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "}"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPlot", "[", 
   RowBox[{"polynomial_", ",", "range_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "polynomial", "]"}], ">", "1"}], ",", 
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], " ", "=", " ", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Pget", "[", 
             RowBox[{"polynomial", ",", "x"}], "]"}], ",", 
            RowBox[{
             RowBox[{"x", "\[GreaterEqual]", 
              RowBox[{
               RowBox[{"polynomial", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
             RowBox[{"x", "<", " ", 
              RowBox[{
               RowBox[{"polynomial", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], "}"}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], " ", "=", " ", 
        RowBox[{"Pget", "[", 
         RowBox[{"polynomial", ",", "x"}], "]"}]}]}], "]"}], ";", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",", "range", ",", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], "}"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5146020856846123`*^9, 3.5146021078838816`*^9}, {
   3.514602143327909*^9, 3.514602183460204*^9}, {3.51460257780976*^9, 
   3.514602667548893*^9}, {3.514602755901946*^9, 3.5146028415178432`*^9}, {
   3.514602877543904*^9, 3.514602957783493*^9}, 3.51460457757114*^9, {
   3.514686264684958*^9, 3.5146863174349747`*^9}, {3.5146868055958967`*^9, 
   3.5146868101991596`*^9}, {3.514686852294567*^9, 3.5146869290879593`*^9}, {
   3.514687641411702*^9, 3.5146878985604105`*^9}, {3.5146879471671906`*^9, 
   3.514688019806345*^9}, {3.5146881422473483`*^9, 3.5146882162455807`*^9}, {
   3.514688408219561*^9, 3.514688427066639*^9}, {3.514688672288665*^9, 
   3.5146886914617615`*^9}, {3.514688877546405*^9, 3.5146890253818607`*^9}, {
   3.5146891908403244`*^9, 3.5146893214457946`*^9}, {3.514689383013316*^9, 
   3.514689416455229*^9}, {3.5146894591796727`*^9, 3.514689494992721*^9}, {
   3.514689543124474*^9, 3.514689547962751*^9}, {3.51468958466285*^9, 
   3.5146896086762233`*^9}, {3.5146897640731115`*^9, 3.514689769245407*^9}, {
   3.5146901393795776`*^9, 3.514690164755029*^9}, {3.5146902270705934`*^9, 
   3.5146902290777082`*^9}, {3.514690277396472*^9, 3.514690290752236*^9}, {
   3.51469042947417*^9, 3.51469043279036*^9}, {3.5146906532829714`*^9, 
   3.514690657612219*^9}, {3.514690703734857*^9, 3.5146907613181505`*^9}, {
   3.514690816811325*^9, 3.51469082145259*^9}, {3.514690925315531*^9, 
   3.514690949344905*^9}, {3.5146910036060085`*^9, 3.5146910472155027`*^9}, {
   3.5146911336984496`*^9, 3.514691137774683*^9}, {3.514691173376719*^9, 
   3.514691176388891*^9}, 3.514691227205798*^9, {3.5146912819569297`*^9, 
   3.5146912869922175`*^9}, {3.5146913201061115`*^9, 3.514691325587425*^9}, {
   3.5146914260001683`*^9, 3.514691434473653*^9}, {3.514691870910616*^9, 
   3.514691908617772*^9}, {3.5146923011752253`*^9, 3.5146923239745293`*^9}, 
   3.514692461085372*^9, {3.514794328112629*^9, 3.5147943934583664`*^9}, {
   3.514794706496271*^9, 3.5147947435833926`*^9}, 3.5151289176734133`*^9, 
   3.5151291233521776`*^9}],

Cell["\<\
\[LineSeparator]\[LineSeparator]A Piecewise Function is a set of bounded \
polynomials {poly1,poly2,...polyn}\
\>", "Text",
 CellChangeTimes->{{3.5146068216274924`*^9, 3.5146069219122286`*^9}, {
   3.5146070105833*^9, 3.5146070527297106`*^9}, 3.514621398725255*^9, 
   3.5151290635007544`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PWIntegrate", "[", 
    RowBox[{"pw_", ",", "bounds_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"PIntegrate", "[", 
       RowBox[{
        RowBox[{"pw", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "bounds"}], "]"}], "   ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWEvaluate", "[", 
    RowBox[{"pw_", ",", "value_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"pw", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"value", " ", "\[GreaterEqual]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"pw", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
          RowBox[{"value", " ", "<", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"pw", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
         RowBox[{"PEvaluate", "[", 
          RowBox[{
           RowBox[{"pw", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "value"}], "]"}], ",", "0"}],
         "]"}], ",", 
       RowBox[{"PEvaluate", "[", 
        RowBox[{
         RowBox[{"pw", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "value"}], "]"}]}], "]"}], 
     "    ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWget", "[", 
    RowBox[{"pw_", ",", "var_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"save", " ", "=", " ", "0"}], ";", " ", 
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Pget", "[", 
                RowBox[{
                 RowBox[{"pw", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "z"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                 RowBox[{
                  RowBox[{"z", "\[GreaterEqual]", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
                  RowBox[{"z", " ", "<", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                 RowBox[{"save", "=", 
                  RowBox[{"Pget", "[", 
                   RowBox[{
                    RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "z"}], "]"}]}]}], 
                "]"}]}], "}"}], "  ", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "1"}], "&"}]}], 
          "]"}], ",", "save"}], "]"}]}], "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
    RowBox[{"z", "\[Rule]", "var"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Piecewise2PW", "[", "piecewise_", "]"}], " ", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"piecewise", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"piecewise", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"piecewise", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "NumericQ"}], "]"}], "]"}]}], "}"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"piecewise", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWPlot", "[", 
    RowBox[{"pw_", ",", "range_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"save", " ", "=", " ", "0"}], ";", 
      RowBox[{
       RowBox[{"f", "[", "x_", "]"}], " ", "=", " ", 
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Pget", "[", 
                RowBox[{
                 RowBox[{"pw", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                 RowBox[{
                  RowBox[{"x", "\[GreaterEqual]", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
                  RowBox[{"x", "<", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                 RowBox[{"save", "=", 
                  RowBox[{"Pget", "[", 
                   RowBox[{"pw", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "]"}]}], "}"}],
              "  ", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "1"}], "&"}]}], 
          "]"}], ",", "save"}], "]"}]}], ";", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",", "range", ",", 
        RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "500"}]}], "]"}]}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTPlot", "[", 
   RowBox[{"pwlist_", ",", "range_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", " ", 
   RowBox[{
    RowBox[{"PWPlot", "[", 
     RowBox[{
      RowBox[{"pwlist", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "range"}], "]"}], "  ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "pwlist", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWFactor", "[", 
    RowBox[{"pw_", ",", "factor_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"PFactor", "[", 
      RowBox[{
       RowBox[{"pw", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "factor"}], "]"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWProd", "[", 
    RowBox[{"pw1_", ",", "pw2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PMult", "[", 
          RowBox[{
           RowBox[{"pw1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"pw2", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pw1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "pw2", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWAdd", "[", 
    RowBox[{"pw1_", ",", "pw2_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", " ", "=", " ", "pw1"}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"u", " ", "=", " ", 
         RowBox[{"PWAddP", "[", 
          RowBox[{
           RowBox[{"pw2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "u"}], "]"}]}], "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "pw2", "]"}]}], "}"}]}], "]"}], ";", " ", 
      "u"}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWSub", "[", 
    RowBox[{"pw1_", ",", "pw2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"PWAdd", "[", 
    RowBox[{"pw1", ",", 
     RowBox[{"PWFactor", "[", 
      RowBox[{"pw2", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWShift", "[", 
    RowBox[{"pw_", ",", "shift_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"u", " ", "=", " ", 
         RowBox[{
          RowBox[{"PAdd", "[", 
           RowBox[{"u", ",", 
            RowBox[{"{", 
             RowBox[{"CoefficientList", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"pw", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "shift"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}]}], ",", "x"}], "]"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"pw", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"pw", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pw", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "shift"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], "   ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWScale", "[", "pw_", "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", "   ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", "2", "]"}], "*", 
       RowBox[{
        RowBox[{"pw", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"pw", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"pw", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"pw", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTShift", "[", 
    RowBox[{"pwlist_", ",", "shift_"}], "]"}], ":=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PWShift", "[", 
      RowBox[{
       RowBox[{"pwlist", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "shift"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pwlist", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTScale", "[", "pwlist_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PWScale", "[", 
      RowBox[{"pwlist", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pwlist", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTSum", "[", 
    RowBox[{"list_", ",", "bounds_"}], "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "list", "]"}], ">", "0"}], ",", 
     RowBox[{
      RowBox[{"hl", " ", "=", " ", 
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{"bounds", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"hl", " ", "=", " ", 
         RowBox[{"PWAdd", "[", 
          RowBox[{"hl", ",", 
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"bounds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", "hl"}], ",",
      "0"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTFactor", "[", 
    RowBox[{"list_", ",", "factor_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PWFactor", "[", 
      RowBox[{
       RowBox[{"list", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "factor"}], "]"}], "   ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTget", "[", 
    RowBox[{"list_", ",", "var_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PWget", "[", 
       RowBox[{
        RowBox[{"list", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], " ", "/.", 
    " ", 
    RowBox[{"y", "\[Rule]", "var"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTSymmetrize", "[", "list_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Length", "[", "list", "]"}], ",", "2"}], "]"}], " ", 
        "\[Equal]", " ", "0"}], ",", "  ", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"PWSub", "[", 
        RowBox[{
         RowBox[{"PWTSum", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{"i", "/", "2"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "list", "]"}], "/", "2"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"PWFactor", "[", 
          RowBox[{
           RowBox[{"PWTSum", "[", 
            RowBox[{"list", " ", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "list", "]"}], "/", "2"}], "+", "1"}],
                ",", 
               RowBox[{
                RowBox[{"Length", "[", "list", "]"}], "+", "1", "-", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"i", "/", "2"}], "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", "i", ")"}]}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t   ", 
       RowBox[{"(*", 
        RowBox[{
        "else", " ", "teil", " ", "vom", " ", "1.", "ten", " ", "if"}], 
        "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[NotEqual]", " ", 
          RowBox[{"Length", "[", "list", "]"}]}], ",", "\[IndentingNewLine]", 
         "\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
         RowBox[{"PWSub", "[", 
          RowBox[{
           RowBox[{"PWTSum", "[", 
            RowBox[{"list", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ceiling", "[", 
                RowBox[{"i", "/", "2"}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "[", "list", "]"}], "-", "1"}], ")"}], 
                "/", "2"}]}], "}"}]}], "]"}], " ", ",", " ", 
           RowBox[{"PWFactor", "[", " ", 
            RowBox[{
             RowBox[{"PWTSum", "[", 
              RowBox[{"list", " ", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "list", "]"}], "+", "1"}], ")"}], 
                   "/", "2"}], "+", "1"}], ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "list", "]"}], "+", "1", "-", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{"i", "/", "2"}], "]"}]}]}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", "i"}]}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t     ", ",", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", "list", "]"}], "+", "1"}], ")"}], "/", 
            "2"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", "\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWNormalize", "[", 
    RowBox[{"pw_", ",", "range_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"pw", ",", "pw"}], "]"}], ",", "range"}], "]"}], "]"}], 
      "\[NotEqual]", " ", "0"}], ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"PWFactor", "[", 
       RowBox[{"pw", ",", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"PWIntegrate", "[", 
           RowBox[{
            RowBox[{"PWProd", "[", 
             RowBox[{"pw", ",", "pw"}], "]"}], ",", "range"}], "]"}], 
          "]"}]}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWProject", "[", 
   RowBox[{"pw1_", ",", "pw2_", ",", "range_"}], "]"}], " ", ":=", " ", 
  RowBox[{"PWFactor", "[", 
   RowBox[{"pw2", ",", " ", 
    RowBox[{"PWIntegrate", "[", 
     RowBox[{
      RowBox[{"PWProd", "[", 
       RowBox[{"pw1", ",", "pw2"}], "]"}], ",", "range"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWOrthProject", "[", 
    RowBox[{"pw1_", ",", "pw2_", ",", "range_"}], "]"}], " ", ":=", " ", 
   RowBox[{"PWSub", "[", 
    RowBox[{"pw1", ",", 
     RowBox[{"PWProject", "[", 
      RowBox[{"pw1", ",", "pw2", ",", "range"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTOrthogonalize", "[", 
    RowBox[{"list_", ",", "range_", ",", "tol_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"orthohlist", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PWNormalize", "[", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "range"}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", 
             RowBox[{"u", " ", "=", " ", 
              RowBox[{"PWNormalize", "[", 
               RowBox[{
                RowBox[{"PWOrthProject", "[", 
                 RowBox[{
                  RowBox[{"orthohlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"orthohlist", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"u", " ", "=", " ", 
              RowBox[{"PWNormalize", "[", 
               RowBox[{
                RowBox[{"PWOrthProject", "[", 
                 RowBox[{"u", ",", 
                  RowBox[{"orthohlist", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], " ", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
         RowBox[{
          RowBox[{"orthohlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "u"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Select", "[", 
       RowBox[{"orthohlist", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"PWIntegrate", "[", 
           RowBox[{
            RowBox[{"PWProd", "[", 
             RowBox[{"#", ",", "#"}], "]"}], ",", "range"}], "]"}], " ", ">", 
          " ", "tol"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"list_", ",", "list2_", ",", "range_", ",", "tol_"}], "]"}], ":=",
    " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"orthohlist1", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PWNormalize", "[", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "range"}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t", 
      RowBox[{"ortholist2", " ", "=", " ", 
       RowBox[{"PWTOrthogonalize", "[", 
        RowBox[{"list2", ",", "range", ",", "tol"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", 
             RowBox[{"u1", " ", "=", " ", 
              RowBox[{"PWNormalize", "[", 
               RowBox[{
                RowBox[{"PWOrthProject", "[", 
                 RowBox[{
                  RowBox[{"orthohlist1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"ortholist2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"u1", " ", "=", " ", 
              RowBox[{"PWNormalize", "[", 
               RowBox[{
                RowBox[{"PWOrthProject", "[", 
                 RowBox[{"u1", ",", 
                  RowBox[{"ortholist2", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], " ", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], "]"}], 
           " ", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "ortholist2", "]"}]}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "   ", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"usave", " ", "=", " ", 
             RowBox[{"PWOrthProject", "[", 
              RowBox[{"u1", ",", 
               RowBox[{"orthohlist1", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
            RowBox[{"u1", " ", "=", " ", 
             RowBox[{"PWNormalize", "[", 
              RowBox[{"usave", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
         RowBox[{
          RowBox[{"orthohlist1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "u1"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Select", "[", 
       RowBox[{"orthohlist1", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"PWIntegrate", "[", 
           RowBox[{
            RowBox[{"PWProd", "[", 
             RowBox[{"#", ",", "#"}], "]"}], ",", "range"}], "]"}], " ", ">", 
          " ", "tol"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTOrthTest", "[", 
    RowBox[{"list_", ",", "range_"}], "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PWIntegrate", "[", 
      RowBox[{
       RowBox[{"PWProd", "[", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "range"}], "]"}], 
     "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTNormalize", "[", 
    RowBox[{"list_", " ", ",", "range_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"PWNormalize", "[", 
      RowBox[{
       RowBox[{"list", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "range"}], "]"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"list1_", ",", "list2_", ",", "range_"}], "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PWIntegrate", "[", 
      RowBox[{
       RowBox[{"PWProd", "[", 
        RowBox[{
         RowBox[{"list1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"list2", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "range"}], "]"}], 
     "   ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list1", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "list2", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTDirichlet", "[", 
    RowBox[{"list_", ",", "range_", ",", "pos_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dbcoeff", " ", "=", " ", 
       RowBox[{"NullSpace", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[Equal]", "1"}], ",", 
            RowBox[{"PWEvaluate", "[", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "pos"}], "]"}], ",", 
            "0"}], "]"}], "    ", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"db", "=", " ", 
       RowBox[{"PWTOrthogonalize", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PWTSum", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"PWFactor", "[", 
                RowBox[{
                 RowBox[{"PWProd", "[", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "1", "}"}], ",", "range"}], "}"}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"dbcoeff", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "dbcoeff", "]"}]}], "}"}]}], "]"}], ",", 
         "range", ",", "eps"}], "]"}]}]}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getx", "[", "number_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xes", " ", "=", " ", "\"\<\>\""}], ";", " ", 
       RowBox[{"Do", "[", " ", 
        RowBox[{
         RowBox[{"xes", "=", " ", 
          RowBox[{"xes", " ", "<>", " ", "\"\<*x\>\""}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "number"}], "}"}]}], "]"}], ";", 
       "xes"}], "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PgetString", "[", 
    RowBox[{"polynomial_", ",", "precision_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pserg", ":=", "\"\<\>\""}], ";", 
      RowBox[{"Do", "[", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "1"}], ",", 
          RowBox[{"pserg", " ", "=", " ", 
           RowBox[{"pserg", " ", "<>", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"polynomial", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ">", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "precision"}], ")"}]}]}], ",", 
              RowBox[{"\"\< + \>\"", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"polynomial", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}], 
                "]"}], "<>", " ", 
               RowBox[{"getx", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"polynomial", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "<", 
                 RowBox[{"-", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "precision"}], ")"}]}]}]}], ",", " ", 
                RowBox[{"\"\< - \>\"", "<>", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"polynomial", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "precision"}],
                    "]"}], "]"}], "<>", " ", 
                 RowBox[{"getx", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], ",", "\"\<\>\""}], 
               "]"}]}], "]"}]}]}], ",", 
          RowBox[{"pserg", " ", "=", " ", 
           RowBox[{"pserg", " ", "<>", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"polynomial", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", " ", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "precision"}], ")"}]}]}], ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"polynomial", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}], 
               "]"}], ",", "\"\<0.\>\""}], "]"}]}]}]}], "]"}], "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "pserg"}], "    ", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "polynomial", "]"}], " ", ">", " ", "1"}], ",", 
       RowBox[{"polynomial", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PGlatten", "[", 
    RowBox[{"polynomial_", ",", "precision_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"polynomial", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "precision"}], ")"}]}]}], ",", "0", ",", 
         RowBox[{
          RowBox[{"polynomial", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "   ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"polynomial", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "polynomial", "]"}], ">", "1"}], ",", 
       RowBox[{"polynomial", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWGlatten", "[", 
    RowBox[{"pw_", ",", "precision_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PGlatten", "[", 
      RowBox[{
       RowBox[{"pw", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}], "    ", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWgetString", "[", 
    RowBox[{"pw_", ",", "precision_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PgetString", "[", 
      RowBox[{
       RowBox[{"PGlatten", "[", 
        RowBox[{
         RowBox[{"pw", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}], ",", 
       "precision"}], "]"}], "   ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PWString2If", "[", 
     RowBox[{
     "pwstring_", ",", "einrueck_", ",", " ", "einruckstufe_", ",", 
      "varname_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pwsort", "=", " ", 
        RowBox[{"Sort", "[", 
         RowBox[{"pwstring", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
            RowBox[{
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], " ", "&"}]}], "]"}]}], ";", 
       " ", 
       RowBox[{"ausgabe", " ", "=", " ", "\"\<\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ein", " ", "=", " ", "\"\<\>\""}], ";", " ", 
       RowBox[{"Do", "[", " ", 
        RowBox[{
         RowBox[{"ein", " ", "=", " ", 
          RowBox[{"ein", " ", "<>", " ", "\"\< \>\""}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "einrueck"}], "}"}]}], "]"}], ";", " ", 
       RowBox[{"einblock", " ", "=", " ", "\"\<\>\""}], ";", 
       RowBox[{"Do", "[", " ", 
        RowBox[{
         RowBox[{"einblock", " ", "=", " ", 
          RowBox[{"einblock", " ", "<>", " ", "\"\< \>\""}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "einruckstufe"}], "}"}]}], "]"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"ausgabe", " ", "=", " ", 
          RowBox[{"ausgabe", "<>", " ", "ein", " ", "<>", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], ",", " ", "\"\<if(\>\"", "  ", 
             ",", "\"\<} else if(\>\""}], "]"}], " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pwsort", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
            " ", "\"\< <= x && x < \>\"", " ", "<>", "  ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pwsort", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
            " ", "\"\<){\\n\>\"", " ", "<>", " ", "ein", " ", "<>", " ", 
           "einblock", " ", "<>", " ", "varname", " ", "<>", " ", 
           "\"\< = \>\"", " ", "<>", " ", 
           RowBox[{
            RowBox[{"pwsort", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "<>", " ", 
           "\"\<;\\n\>\""}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pwstring", "]"}]}], "}"}]}], "]"}], ";", 
       " ", 
       RowBox[{"ausgabe", " ", "=", " ", 
        RowBox[{
        "ausgabe", " ", "<>", " ", "ein", " ", "<>", "\"\<} else {\\n\>\"", "<>",
          "ein", "<>", "einblock", "<>", "varname", "<>", " ", 
         "\"\< = 0.0;\\n\>\"", "<>", " ", "ein", " ", "<>", " ", 
         "\"\<}\>\""}]}]}], "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWDeriv", "[", "pw_", "]"}], " ", ":=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"pw", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ">", " ", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"pw", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], "  ", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"pw", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"pw", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
             RowBox[{
              RowBox[{"pw", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], "    ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}], " ", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PgetString2", "[", 
    RowBox[{"polynomial_", ",", "precision_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pserg", ":=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"pserg", "=", 
         RowBox[{"pserg", "<>", "\"\<(\>\""}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"polynomial", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"polynomial", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"pserg", "=", 
           RowBox[{"pserg", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"polynomial", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "precision"}], ")"}]}]}], ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"CForm", "[", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"polynomial", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}],
                   "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"100", ",", "40"}], "}"}]}], "]"}], "]"}], ",", 
              "\"\<0.\>\""}], "]"}]}]}], ",", 
          RowBox[{"pserg", "=", 
           RowBox[{"pserg", "<>", "\"\<)*x\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"polynomial", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ">", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "precision"}], ")"}]}]}], ",", 
              RowBox[{"\"\< + \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"CForm", "[", 
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"polynomial", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}],
                    "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"100", ",", "40"}], "}"}]}], "]"}], "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"polynomial", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "<", 
                 RowBox[{"-", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "precision"}], ")"}]}]}]}], ",", 
                RowBox[{"\"\< - \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"CForm", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"polynomial", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "precision"}],
                     "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "40"}], "}"}]}], "]"}], "]"}]}], ",", 
                "\"\<\>\""}], "]"}]}], "]"}]}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"polynomial", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "pserg"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "polynomial", "]"}], ">", "1"}], ",", 
       RowBox[{"polynomial", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWgetString2", "[", 
    RowBox[{"pw_", ",", "precision_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PgetString2", "[", 
      RowBox[{
       RowBox[{"PGlatten", "[", 
        RowBox[{
         RowBox[{"pw", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "precision"}], "]"}], ",", 
       "precision"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pw", "]"}]}], "}"}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWPrintFun", "[", 
    RowBox[{
    "pw_", ",", "name_", ",", "type_", ",", "position_", ",", "number_", ",", 
     "varname_", ",", "precision_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"funtext", " ", "=", " ", 
       RowBox[{
       "\"\<template <typename T>\\nT\\n_\>\"", " ", "<>", " ", "name", " ", "<>",
         " ", "\"\<_\>\"", " ", "<>", "type", " ", "<>", " ", "\"\<_\>\"", 
        " ", "<>", "position", " ", "<>", "\"\<_evaluator\>\"", "<>", 
        RowBox[{"ToString", "[", "number", "]"}], "<>", 
        "\"\<(T x, unsigned short deriv){\\n\\n    T \>\"", " ", "<>", " ", 
        "varname", " ", "<>", " ", 
        "\"\< = 0.0;\\n\\n    if(deriv == 0){\\n\>\"", "<>", 
        RowBox[{"PWString2If", "[", 
         RowBox[{
          RowBox[{"PWgetString2", "[", 
           RowBox[{"pw", ",", "precision"}], "]"}], ",", "8", ",", "4", ",", 
          "varname"}], "]"}], " ", "<>", " ", 
        "\"\<\\n    } else if (deriv == 1){\\n\>\"", " ", "<>", "  ", 
        RowBox[{"PWString2If", "[", 
         RowBox[{
          RowBox[{"PWgetString2", "[", 
           RowBox[{
            RowBox[{"PWDeriv", "[", "pw", "]"}], ",", "precision"}], "]"}], 
          ",", "8", ",", "4", ",", "varname"}], "]"}], " ", "<>", " ", 
        "\"\<\\n    } else {\\n        \>\"", "<>", "varname", " ", "<>", 
        " ", "\"\< = 0.0;\\n    }\\n    return \>\"", "<>", "varname", " ", 
        "<>", "\"\<;\\n}\>\""}]}], ";", "\[IndentingNewLine]", "funtext"}], 
     "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setEvaluatorLeft", "[", 
    RowBox[{"left_", ",", "inner_", ",", "name_", ",", "type_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"basisinner", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PWIntegrate", "[", 
               RowBox[{
                RowBox[{"PWProd", "[", 
                 RowBox[{
                  RowBox[{"inner", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"inner", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ">", "0"}], 
             ",", "0", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "inner", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", ">", "0"}], " ", "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leftcppstring", " ", "=", " ", "\"\<\>\""}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t", 
      RowBox[{"leftcppstring", " ", "=", " ", 
       RowBox[{"\"\<_numLeftParts = \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Length", "[", "left", "]"}], "+", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "]"}], " ", "<>", 
        " ", "\"\<;\\n_leftEvaluator = new Evaluator[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Length", "[", "left", "]"}], "+", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"leftcppstring", " ", "=", " ", 
         RowBox[{
         "leftcppstring", " ", "<>", " ", "\"\<_leftEvaluator[\>\"", " ", "<>",
           " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = _\>\"", "<>", 
          "name", " ", "<>", " ", "\"\<_\>\"", "<>", "type", "<>", 
          "\"\<_left_evaluator\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<;\\n\>\""}]}], "  ", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "left", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"leftcppstring", " ", "=", " ", 
         RowBox[{
         "leftcppstring", " ", "<>", " ", "\"\<_leftEvaluator[\>\"", " ", "<>",
           " ", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"Length", "[", "left", "]"}], "+", "i", "-", "1"}], "]"}],
           "<>", "\"\<] = _\>\"", "<>", "name", " ", "<>", " ", "\"\<_\>\"", "<>",
           "type", "<>", "\"\<_inner_evaluator\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"basisinner", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], " ", "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leftcppstring", " ", "=", " ", 
       RowBox[{
       "leftcppstring", " ", "<>", 
        "\"\<\\n_leftSupport = new Support<T>[\>\"", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Length", "[", "left", "]"}], "+", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"leftsupp", "  ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"left", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "   ", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"left", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}], "]"}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "left", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"innersupp", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"inner", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "   ", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"inner", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}], "]"}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "inner", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"leftcppstring", " ", "=", " ", 
         RowBox[{"leftcppstring", " ", "<>", " ", "\"\<_leftSupport[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = Support<T>(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Min", "[", 
             RowBox[{"leftsupp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<,\>\"", " ", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Max", "[", 
             RowBox[{"leftsupp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", " ", 
          "\"\<);\\n\>\""}]}], "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "left", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"leftcppstring", " ", "=", " ", 
         RowBox[{"leftcppstring", " ", "<>", " ", "\"\<_leftSupport[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"Length", "[", "left", "]"}], "+", "i", "-", "1"}], "]"}],
           "<>", "\"\<] = Support<T>(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Min", "[", 
             RowBox[{"innersupp", "[", 
              RowBox[{"[", 
               RowBox[{"basisinner", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "]"}], 
           "]"}], "<>", "\"\<,\>\"", " ", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Max", "[", 
             RowBox[{"innersupp", "[", 
              RowBox[{"[", 
               RowBox[{"basisinner", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "]"}], 
           "]"}], "<>", " ", "\"\<);\\n\>\""}]}], "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leftcppstring", " ", "=", " ", 
       RowBox[{
       "leftcppstring", " ", "<>", " ", 
        "\"\<\\n_leftSingularSupport = new DenseVector<Array<T> >[\>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Length", "[", "left", "]"}], "+", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"leftcppstring", " ", "=", " ", 
          RowBox[{
          "leftcppstring", " ", "<>", " ", "\"\<_leftSingularSupport[\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = \>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", 
             RowBox[{"leftcppstring", " ", "=", " ", 
              RowBox[{"leftcppstring", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"leftsupp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], "    ", 
             ",", 
             RowBox[{"leftcppstring", " ", "=", " ", 
              RowBox[{
              "leftcppstring", " ", "<>", " ", "\"\<, \>\"", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"leftsupp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"leftsupp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
         " ", 
         RowBox[{"leftcppstring", " ", "=", " ", 
          RowBox[{"leftcppstring", " ", "<>", " ", "\"\<;\\n\>\""}]}]}], "  ",
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "left", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"leftcppstring", " ", "=", " ", 
          RowBox[{
          "leftcppstring", " ", "<>", " ", "\"\<_leftSingularSupport[\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"Length", "[", "left", "]"}], "+", "i", "-", "1"}], 
            "]"}], "<>", "\"\<] = \>\""}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", 
             RowBox[{"leftcppstring", " ", "=", " ", 
              RowBox[{"leftcppstring", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"innersupp", "[", 
                   RowBox[{"[", 
                    RowBox[{"basisinner", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], "  ", ",", 
             RowBox[{"leftcppstring", " ", "=", " ", 
              RowBox[{"leftcppstring", " ", "<>", "  ", "\"\<, \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"innersupp", "[", 
                   RowBox[{"[", 
                    RowBox[{"basisinner", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}]}], " ", 
            "]"}], "  ", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"innersupp", "[", 
               RowBox[{"[", 
                RowBox[{"basisinner", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
            "}"}]}], "]"}], ";", " ", 
         RowBox[{"leftcppstring", " ", "=", " ", 
          RowBox[{"leftcppstring", " ", "<>", " ", "\"\<;\\n\>\""}]}]}], "  ",
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leftcppstring", " ", "=", " ", 
       RowBox[{
       "leftcppstring", " ", "<>", " ", 
        "\"\<\\n_leftScalingFactors.engine().resize(\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Length", "[", "left", "]"}], "+", 
          RowBox[{"Length", "[", "basisinner", "]"}]}], "]"}], "<>", 
        "\"\<,0);\\n_leftScalingFactors = \>\""}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", 
          RowBox[{"leftcppstring", " ", "=", " ", 
           RowBox[{"leftcppstring", " ", "<>", "\"\<1.0\>\""}]}], ",", 
          RowBox[{"leftcppstring", " ", "=", " ", 
           RowBox[{"leftcppstring", " ", "<>", "\"\<, 1.0\>\""}]}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "left", "]"}], "+", 
           RowBox[{"Length", "[", "basisinner", "]"}]}]}], "}"}]}], "]"}], 
      ";", 
      RowBox[{"leftcppstring", " ", "=", " ", 
       RowBox[{"leftcppstring", " ", "<>", "\"\<;\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "leftcppstring"}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setEvaluatorRight", "[", 
    RowBox[{"right_", ",", "name_", ",", "type_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rightcppstring", " ", "=", " ", "\"\<\>\""}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t", 
      RowBox[{"rightcppstring", " ", "=", " ", 
       RowBox[{"\"\<_numRightParts = \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "right", "]"}], "]"}], " ", "<>", " ", 
        "\"\<;\\n_rightEvaluator = new Evaluator[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "right", "]"}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"rightcppstring", " ", "=", " ", 
         RowBox[{
         "rightcppstring", " ", "<>", " ", "\"\<_rightEvaluator[\>\"", " ", "<>",
           " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = _\>\"", "<>", 
          "name", " ", "<>", " ", "\"\<_\>\"", "<>", "type", "<>", 
          "\"\<_right_evaluator\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<;\\n\>\""}]}], "  ", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "right", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rightcppstring", " ", "=", " ", 
       RowBox[{
       "rightcppstring", " ", "<>", 
        "\"\<\\n_rightSupport = new Support<T>[\>\"", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "right", "]"}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rightsupp", "  ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"right", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "   ", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"right", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}], "]"}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "right", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"rightcppstring", " ", "=", " ", 
         RowBox[{"rightcppstring", " ", "<>", " ", "\"\<_rightSupport[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = Support<T>(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Min", "[", 
             RowBox[{"rightsupp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<,\>\"", " ", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Max", "[", 
             RowBox[{"rightsupp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", " ", 
          "\"\<);\\n\>\""}]}], "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "right", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rightcppstring", " ", "=", 
       RowBox[{
       "rightcppstring", " ", "<>", " ", 
        "\"\<\\n_rightSingularSupport = new DenseVector<Array<T> >[\>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "right", "]"}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rightcppstring", " ", "=", " ", 
          RowBox[{
          "rightcppstring", " ", "<>", " ", "\"\<_rightSingularSupport[\>\"", 
           "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = \>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", 
             RowBox[{"rightcppstring", " ", "=", " ", 
              RowBox[{"rightcppstring", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"rightsupp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], " ", ",", 
             RowBox[{"rightcppstring", " ", "=", " ", 
              RowBox[{
              "rightcppstring", " ", "<>", "  ", "\"\<, \>\"", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"rightsupp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}]}], "]"}], 
           "  ", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"rightsupp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
         " ", 
         RowBox[{"rightcppstring", " ", "=", " ", 
          RowBox[{"rightcppstring", " ", "<>", " ", "\"\<;\\n\>\""}]}]}], 
        "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "right", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rightcppstring", " ", "=", 
       RowBox[{
       "rightcppstring", " ", "<>", " ", 
        "\"\<\\n_rightScalingFactors.engine().resize(\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "right", "]"}], "]"}], "<>", 
        "\"\<,0);\\n_rightScalingFactors = \>\""}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", 
          RowBox[{"rightcppstring", " ", "=", " ", 
           RowBox[{"rightcppstring", " ", "<>", "\"\<1.0\>\""}]}], ",", 
          RowBox[{"rightcppstring", " ", "=", " ", 
           RowBox[{"rightcppstring", " ", "<>", "\"\<, 1.0\>\""}]}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "right", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"leftcppstring", " ", "=", " ", 
       RowBox[{"leftcppstring", " ", "<>", "\"\<;\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", "rightcppstring"}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setEvaluatorInner", "[", 
    RowBox[{"inner_", ",", "name_", ",", "type_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"innercppstring", " ", "=", " ", "\"\<\>\""}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t", 
      RowBox[{"innercppstring", " ", "=", " ", 
       RowBox[{"\"\<_numInnerParts = \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "inner", "]"}], "]"}], " ", "<>", " ", 
        "\"\<;\\n_innerEvaluator = new Evaluator[\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "inner", "]"}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"innercppstring", " ", "=", " ", 
         RowBox[{
         "innercppstring", " ", "<>", " ", "\"\<_innerEvaluator[\>\"", " ", "<>",
           " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = _\>\"", "<>", 
          "name", " ", "<>", " ", "\"\<_\>\"", "<>", "type", "<>", 
          "\"\<_inner_evaluator\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<;\\n\>\""}]}], "  ", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "inner", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"innercppstring", " ", "=", " ", 
       RowBox[{
       "innercppstring", " ", "<>", 
        "\"\<\\n_innerSupport = new Support<T>[\>\"", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "inner", "]"}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"innersupp", "  ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"inner", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "   ", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"inner", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}], "]"}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "inner", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"innercppstring", " ", "=", " ", 
         RowBox[{"innercppstring", " ", "<>", " ", "\"\<_innerSupport[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = Support<T>(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Min", "[", 
             RowBox[{"innersupp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<,\>\"", " ", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Max", "[", 
             RowBox[{"innersupp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", " ", 
          "\"\<);\\n\>\""}]}], "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "inner", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"innercppstring", " ", "=", 
       RowBox[{
       "innercppstring", " ", "<>", " ", 
        "\"\<\\n_innerSingularSupport = new DenseVector<Array<T> >[\>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "inner", "]"}], "]"}], "<>", 
        "\"\<];\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"innercppstring", " ", "=", " ", 
          RowBox[{
          "innercppstring", " ", "<>", " ", "\"\<_innerSingularSupport[\>\"", 
           "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<] = \>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", 
             RowBox[{"innercppstring", " ", "=", " ", 
              RowBox[{"innercppstring", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"innersupp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], " ", ",", 
             RowBox[{"innercppstring", " ", "=", " ", 
              RowBox[{
              "innercppstring", " ", "<>", "  ", "\"\<, \>\"", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"innersupp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}]}], "]"}], 
           "  ", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"innersupp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
         " ", 
         RowBox[{"innercppstring", " ", "=", " ", 
          RowBox[{"innercppstring", " ", "<>", " ", "\"\<;\\n\>\""}]}]}], 
        "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "inner", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "innercppstring"}], "}"}],
     "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PWTSimplify", "[", 
     RowBox[{"list_", ",", "decimalplaces_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"list", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "l", "]"}], "]"}], "]"}], ">", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "decimalplaces"}], ")"}]}]}], ",", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"list", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "l", "]"}], "]"}], ",", "decimalplaces"}], "]"}], 
            ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "   ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTExportGraphics", "[", 
    RowBox[{
    "path_", ",", "name_", ",", "type_", ",", "list_", ",", "plotrange_", ",",
      "label_"}], "]"}], " ", ":=", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "path", "<>", " ", "name", "<>", "\"\<_\>\"", "<>", "type", "<>", 
        "\"\<_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<.pdf\>\""}],
        ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PWIntegrate", "[", 
           RowBox[{
            RowBox[{"PWProd", "[", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ">", "0"}], " ",
          ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"PWget", "[", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "plotrange"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", " ", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            SubscriptBox["label", "i"]}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"PWget", "[", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "plotrange"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", " ", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            SubscriptBox["label", "i"]}]}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTGetPlotRanges", "[", "list_", "]"}], ":=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Maximize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PWget", "[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], ",", 
              RowBox[{
               RowBox[{"x", " ", "\[GreaterEqual]", " ", 
                RowBox[{"-", "1"}]}], " ", "&&", " ", 
               RowBox[{"x", " ", "\[LessEqual]", " ", "1"}]}]}], "}"}], ",", 
            "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "]"}], "*",
       "1.05"}], "\[IndentingNewLine]", ",", " ", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Minimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PWget", "[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], ",", 
              RowBox[{
               RowBox[{"x", " ", "\[GreaterEqual]", " ", 
                RowBox[{"-", "1"}]}], " ", "&&", " ", 
               RowBox[{"x", " ", "\[LessEqual]", " ", "1"}]}]}], "}"}], ",", 
            "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "]"}], "*",
       "1.05"}]}], "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTWriteTexFunctions", "[", 
    RowBox[{"list_", ",", "labelstart_", ",", "labelend_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tc1", " ", "=", " ", "\"\<\>\""}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"tc1", " ", "=", " ", 
         RowBox[{"tc1", " ", "<>", " ", "labelstart", "<>", " ", 
          RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "labelend", "<>",
           " ", "\"\< & = & \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"TeXForm", "[", 
            RowBox[{"PWget", "[", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "]"}], 
           "]"}], " ", "<>", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[NotEqual]", " ", 
             RowBox[{"Length", "[", "list", "]"}]}], ",", 
            "\"\<\\\\\\\\\\n\>\"", ",", "\"\<\>\""}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", " ", 
      "tc1"}], "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTWriteTexGraphicTable", "[", 
    RowBox[{"list_", ",", "name_", ",", "type_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tc2", " ", "=", " ", "\"\<\\\\begin{tabular}{\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"tc2", " ", "=", " ", 
         RowBox[{"tc2", " ", "<>", " ", "\"\<c\>\""}]}], "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Ceiling", "[", 
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "/", 
            RowBox[{"Floor", "[", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}]}], "]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"20", "/", 
        RowBox[{"(", 
         RowBox[{"Ceiling", "[", 
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "/", 
           RowBox[{"Floor", "[", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}]}], "]"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tc2", "=", " ", 
       RowBox[{"tc2", " ", "<>", " ", "\"\<}\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", 
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"Length", "[", "list", "]"}], "/", 
                RowBox[{"Floor", "[", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}]}], 
               "]"}]}], "]"}], "\[Equal]", "1"}], " ", "||", " ", 
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], " ", "\[Equal]", " ", 
            "1"}]}], ",", 
          RowBox[{"tc2", " ", "=", " ", 
           RowBox[{
           "tc2", " ", "<>", " ", "\"\<\\\\includegraphics[width=\>\"", "<>", 
            " ", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{"ps", ",", "2"}], "]"}], "]"}], "<>", "\"\<cm]{\>\"", "<>",
             "name", " ", "<>", "\"\<_\>\"", "<>", "type", "<>", "\"\<_\>\"", 
            "<>", 
            RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf}\>\""}]}], 
          " ", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"i", ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "list", "]"}], "/", 
                 RowBox[{"Floor", "[", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
            RowBox[{"tc2", " ", "=", " ", 
             RowBox[{
             "tc2", " ", "<>", " ", "\"\<& \\\\includegraphics[width=\>\"", "<>",
               " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{"ps", ",", "2"}], "]"}], "]"}], "<>", "\"\<cm]{\>\"", 
              "<>", "name", " ", "<>", "\"\<_\>\"", "<>", "type", "<>", 
              "\"\<_\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              "\"\<.pdf} \\\\\\\\\\n\>\""}]}], ",", 
            RowBox[{"tc2", " ", "=", " ", 
             RowBox[{
             "tc2", " ", "<>", " ", "\"\<& \\\\includegraphics[width=\>\"", "<>",
               " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{"ps", ",", "2"}], "]"}], "]"}], "<>", "\"\<cm]{\>\"", 
              "<>", "name", " ", "<>", "\"\<_\>\"", "<>", "type", "<>", 
              "\"\<_\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              "\"\<.pdf}\>\""}]}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"tc2", " ", "=", " ", 
       RowBox[{"tc2", " ", "<>", " ", "\"\<\\\\end{tabular} \\n\>\""}]}]}], 
     "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PWTWriteTexValidationTable", "[", 
    RowBox[{
    "list_", ",", "upperleftcorner_", ",", "labelstarttop_", ",", 
     "labelendtop_", ",", "labelstartleft_", ",", "labelendleft_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ot", " ", "=", " ", 
       RowBox[{"MantissaExponent", "[", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"PWTOrthTest", "[", 
           RowBox[{"list", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "5"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tex", "=", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ot", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", 
            RowBox[{"-", "5"}]}], ",", 
           RowBox[{"TeXForm", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ot", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ot", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ",", "5"}], 
             "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{"10", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"ot", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "<>", " ", 
            "\"\<\\\\cdot 10^{(\>\"", " ", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ot", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "]"}], " ", "<>", 
            "\"\<)}\>\""}]}], "  ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tc3", " ", "=", " ", "\"\<$$ \\\\begin{array}{\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", 
          RowBox[{"tc3", " ", "=", "   ", 
           RowBox[{"tc3", " ", "<>", " ", "\"\<l|\>\""}]}], ",", 
          RowBox[{"tc3", " ", "=", "   ", 
           RowBox[{"tc3", " ", "<>", " ", "\"\<l\>\""}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], "}"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"tc3", " ", "=", " ", 
       RowBox[{"tc3", "<>", " ", "\"\<}\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], " ", "&&", " ", 
           RowBox[{"j", " ", "\[Equal]", " ", "1"}]}], ",", 
          RowBox[{"tc3", "=", " ", 
           RowBox[{"tc3", " ", "<>", " ", "upperleftcorner"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], " ", "&&", " ", 
             RowBox[{"j", " ", "\[LessEqual]", " ", 
              RowBox[{"Length", "[", "list", "]"}]}]}], ",", 
            RowBox[{"tc3", " ", "=", " ", 
             RowBox[{
             "tc3", " ", "<>", " ", "\"\<& \>\"", "<>", "labelstarttop", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"j", "-", "1"}], "]"}], "<>", " ", "labelendtop"}]}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", "\[Equal]", "1"}], " ", "&&", " ", 
               RowBox[{"j", " ", "\[Equal]", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}]}], ",", 
              RowBox[{"tc3", " ", "=", " ", 
               RowBox[{
               "tc3", " ", "<>", " ", "\"\<& \>\"", " ", "<>", " ", 
                "labelstarttop", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"j", "-", "1"}], "]"}], " ", "<>", " ", 
                "labelendtop", " ", "<>", " ", 
                "\"\< \\\\\\\\ \\\\hline \\n \>\""}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "1"}], ",", 
                RowBox[{"tc3", " ", "=", " ", 
                 RowBox[{"tc3", " ", "<>", " ", "labelstartleft", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"i", "-", "1"}], "]"}], "<>", "labelendleft"}]}], 
                ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"j", "\[LessEqual]", 
                   RowBox[{"Length", "[", "list", "]"}]}], ",", 
                  RowBox[{"tc3", " ", "=", " ", 
                   RowBox[{"tc3", "<>", " ", "\"\< & \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"tex", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "]"}]}]}], ",", 
                  RowBox[{"tc3", "=", " ", 
                   RowBox[{"tc3", "<>", " ", "\"\< & \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"tex", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "]"}], "<>", 
                    "\"\< \\\\\\\\ \\n\>\""}]}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}], "   ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], "}"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"tc3", "=", " ", 
       RowBox[{"tc3", " ", "<>", " ", "\"\<\\\\end{array} $$\\n\>\""}]}], ";",
       " ", "\[IndentingNewLine]", "tc3"}], "\[IndentingNewLine]", "}"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTWriteTexValidationTableV2", "[", 
   RowBox[{
   "list_", ",", "list2_", ",", "upperleftcorner_", ",", "labelstarttop_", 
    ",", "labelendtop_", ",", "labelstartleft_", ",", "labelendleft_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"otl", " ", "=", " ", 
      RowBox[{"MantissaExponent", "[", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"PWTIntProd", "[", 
          RowBox[{"list", ",", "list2", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "5"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"texl", "=", " ", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"otl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", 
           RowBox[{"-", "5"}]}], ",", 
          RowBox[{"TeXForm", "[", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"otl", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"otl", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ",", "5"}], "]"}],
            "]"}], ",", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", 
             RowBox[{"10", "*", 
              RowBox[{
               RowBox[{
                RowBox[{"otl", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "<>", " ", 
           "\"\<\\\\cdot 10^{(\>\"", " ", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"otl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "]"}], " ", "<>", 
           "\"\<)}\>\""}]}], "  ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "list2", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tc4", " ", "=", " ", "\"\<$$ \\\\begin{array}{\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "1"}], ",", 
         RowBox[{"tc4", "=", "   ", 
          RowBox[{"tc4", " ", "<>", " ", "\"\<l|\>\""}]}], ",", 
         RowBox[{"tc4", " ", "=", " ", 
          RowBox[{"tc4", " ", "<>", " ", "\"\<l\>\""}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "list2", "]"}], "+", "1"}]}], "}"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"tc4", " ", "=", " ", 
      RowBox[{"tc4", "<>", " ", "\"\<}\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"j", " ", "\[Equal]", " ", "1"}]}], ",", 
         RowBox[{"tc4", "=", " ", 
          RowBox[{"tc4", " ", "<>", " ", "upperleftcorner"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], " ", "&&", " ", 
            RowBox[{"j", " ", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", "list2", "]"}]}]}], ",", 
           RowBox[{"tc4", " ", "=", " ", 
            RowBox[{
            "tc4", " ", "<>", " ", "\"\<& \>\"", "<>", "labelstarttop", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"j", "-", "1"}], "]"}], "<>", " ", "labelendtop"}]}], 
           ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "\[Equal]", "1"}], " ", "&&", " ", 
              RowBox[{"j", " ", "\[Equal]", " ", 
               RowBox[{
                RowBox[{"Length", "[", "list2", "]"}], "+", "1"}]}]}], ",", 
             RowBox[{"tc4", " ", "=", " ", 
              RowBox[{
              "tc4", " ", "<>", " ", "\"\<& \>\"", " ", "<>", " ", 
               "labelstarttop", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"j", "-", "1"}], "]"}], " ", "<>", " ", "labelendtop",
                " ", "<>", " ", "\"\< \\\\\\\\ \\\\hline \\n \>\""}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "\[Equal]", "1"}], ",", 
               RowBox[{"tc4", " ", "=", " ", 
                RowBox[{
                "tc4", " ", "<>", " ", "labelstartleft", " ", "<>", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"i", "-", "1"}], "]"}], " ", "<>", " ", 
                 "labelendleft"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"j", "\[LessEqual]", 
                  RowBox[{"Length", "[", "list2", "]"}]}], ",", 
                 RowBox[{"tc4", " ", "=", " ", 
                  RowBox[{"tc4", "<>", " ", "\"\< & \>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"texl", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"tc4", "=", " ", 
                  RowBox[{"tc4", "<>", " ", "\"\< & \>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"texl", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "]"}], "<>", 
                   "\"\< \\\\\\\\ \\n\>\""}]}]}], "]"}]}], "]"}]}], "]"}]}], 
          "]"}]}], "]"}], "   ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "list2", "]"}], "+", "1"}]}], "}"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"tc4", "=", " ", 
      RowBox[{"tc4", " ", "<>", " ", "\"\<\\\\end{array} $$ \\n\>\""}]}], ";",
      " ", "\[IndentingNewLine]", "tc4"}], "\[IndentingNewLine]", "}"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\n"}], "Input",
 CellChangeTimes->{{3.514607240625458*^9, 3.5146073425502872`*^9}, {
   3.514607432683443*^9, 3.5146074351435833`*^9}, {3.5146863343289413`*^9, 
   3.5146863349559774`*^9}, {3.514686394010355*^9, 3.51468647102776*^9}, {
   3.5146865072548323`*^9, 3.514686587451419*^9}, {3.514686624671548*^9, 
   3.51468671929996*^9}, {3.5146914912419*^9, 3.5146915567526464`*^9}, {
   3.5146924920741444`*^9, 3.5146925911348104`*^9}, {3.5146931968504553`*^9, 
   3.5146934341420274`*^9}, {3.5146934935374246`*^9, 
   3.5146934982026916`*^9}, {3.5146935449303637`*^9, 3.514693547143491*^9}, {
   3.51469359381816*^9, 3.514693597224355*^9}, {3.5146936536055803`*^9, 
   3.514693654432627*^9}, {3.5146937471969333`*^9, 3.514693783651018*^9}, {
   3.5146982205677953`*^9, 3.514698231534423*^9}, {3.514698282344329*^9, 
   3.514698385331219*^9}, {3.5146984272406163`*^9, 3.5146985282023907`*^9}, {
   3.5147004903866215`*^9, 3.5147004971750097`*^9}, {3.5147005554843445`*^9, 
   3.5147005594945745`*^9}, {3.51470681047211*^9, 3.5147068230338283`*^9}, {
   3.5147085283743677`*^9, 3.514708553302794*^9}, {3.5147106054991727`*^9, 
   3.514710625138296*^9}, {3.514710666451659*^9, 3.514710666908685*^9}, {
   3.514710732397431*^9, 3.514710767380432*^9}, {3.5147108233366327`*^9, 
   3.5147108244286947`*^9}, {3.514710994124401*^9, 3.5147110422281523`*^9}, {
   3.5147110955092*^9, 3.5147111237438145`*^9}, {3.5147111630780644`*^9, 
   3.514711197353025*^9}, {3.5147112307149334`*^9, 3.5147112843640013`*^9}, {
   3.514711349230712*^9, 3.5147113593002877`*^9}, {3.5147113913481207`*^9, 
   3.5147114293342934`*^9}, {3.514711630770815*^9, 3.5147117109934034`*^9}, {
   3.5147117849866357`*^9, 3.514711807672933*^9}, {3.5147118998502054`*^9, 
   3.5147119409725575`*^9}, {3.5147120392111764`*^9, 
   3.5147120471476307`*^9}, {3.5147120775193677`*^9, 3.514712082062628*^9}, {
   3.5147121429081078`*^9, 3.514712224760789*^9}, {3.5147122950108075`*^9, 
   3.514712329077756*^9}, {3.5147124022679424`*^9, 3.5147124030989895`*^9}, {
   3.5147125706495733`*^9, 3.5147126090317683`*^9}, {3.514712991024617*^9, 
   3.514712996543933*^9}, {3.514713170736896*^9, 3.5147132656893272`*^9}, {
   3.51471448102284*^9, 3.5147144911674204`*^9}, {3.514715211894644*^9, 
   3.514715258206292*^9}, {3.514715300005683*^9, 3.5147153011637497`*^9}, {
   3.5147153472013826`*^9, 3.514715356922939*^9}, {3.514715415184271*^9, 
   3.51471543299429*^9}, {3.5147158387885*^9, 3.514715919087093*^9}, {
   3.514715977363426*^9, 3.5147160289873786`*^9}, {3.5147160681306176`*^9, 
   3.5147160736259317`*^9}, {3.5147161977450314`*^9, 
   3.5147162245265627`*^9}, {3.5147162646468573`*^9, 
   3.5147162783696423`*^9}, {3.5147163159967947`*^9, 3.514716340709208*^9}, {
   3.514716474758875*^9, 3.5147164908407955`*^9}, {3.514716728139368*^9, 
   3.5147167386079664`*^9}, {3.5147168723316154`*^9, 3.51471690843968*^9}, {
   3.5147169628517923`*^9, 3.514717011728588*^9}, {3.514717217387351*^9, 
   3.5147172502212296`*^9}, {3.514717427622376*^9, 3.5147174319486237`*^9}, {
   3.514717537688671*^9, 3.514717641468607*^9}, {3.514717712053644*^9, 
   3.514717829254348*^9}, {3.5147179136101727`*^9, 3.5147179539144783`*^9}, {
   3.5147216867888603`*^9, 3.5147217211838274`*^9}, {3.5147218116400013`*^9, 
   3.5147218220205946`*^9}, {3.5147218946787505`*^9, 
   3.5147219216962957`*^9}, {3.5147219654157963`*^9, 3.51472199066024*^9}, {
   3.5147236933326273`*^9, 3.514723744113532*^9}, {3.514723806825119*^9, 
   3.514723812365436*^9}, {3.514723844444271*^9, 3.5147238488165207`*^9}, {
   3.5147241533129373`*^9, 3.5147242125413246`*^9}, {3.514724257646905*^9, 
   3.5147243351653385`*^9}, {3.5147244298737555`*^9, 3.514724490113201*^9}, {
   3.514724729887915*^9, 3.514724732835084*^9}, {3.5147248429883842`*^9, 
   3.5147248431273923`*^9}, {3.514724881090564*^9, 3.5147249432081165`*^9}, {
   3.5147251478738227`*^9, 3.514725157585378*^9}, {3.5147256009737387`*^9, 
   3.5147257226126957`*^9}, {3.5147259725919943`*^9, 
   3.5147259936141963`*^9}, {3.514726050519451*^9, 3.5147260900027094`*^9}, {
   3.514785170154824*^9, 3.514785209212058*^9}, {3.5147854709490285`*^9, 
   3.514785476456343*^9}, {3.514788118527461*^9, 3.5147881384456005`*^9}, {
   3.514788174614669*^9, 3.514788208039581*^9}, {3.514791664886301*^9, 
   3.51479169161483*^9}, {3.5147919085782394`*^9, 3.5147919461343875`*^9}, {
   3.5147920626570525`*^9, 3.5147921042534313`*^9}, {3.5147924671421876`*^9, 
   3.514792480130931*^9}, {3.514792618711857*^9, 3.5147926283664093`*^9}, {
   3.5147927038557267`*^9, 3.51479270810897*^9}, {3.5147927992031803`*^9, 
   3.5147928440487456`*^9}, {3.5147928847650747`*^9, 
   3.5147928882052712`*^9}, {3.5147929282875633`*^9, 
   3.5147929647526493`*^9}, {3.5147948301523438`*^9, 3.514794868168518*^9}, {
   3.5147966667373905`*^9, 3.5147966869415464`*^9}, 3.5147967170492687`*^9, 
   3.51479680991758*^9, {3.514797306167964*^9, 3.514797364437297*^9}, {
   3.5147976755610924`*^9, 3.5147976785502634`*^9}, {3.514797714666329*^9, 
   3.5147977421369*^9}, {3.5147980839434505`*^9, 3.514798091211866*^9}, {
   3.5147981925006595`*^9, 3.5147982558742843`*^9}, {3.514798372753969*^9, 
   3.514798376759198*^9}, {3.5151291545669627`*^9, 3.515129289555684*^9}, 
   3.5151293797168407`*^9, {3.51513054888008*^9, 3.515130560736101*^9}, {
   3.5151314643137674`*^9, 3.5151315381954966`*^9}, {3.5151321043204913`*^9, 
   3.515132127112131*^9}, {3.5151322673563776`*^9, 3.5151322717399855`*^9}, {
   3.515132343297311*^9, 3.51513234866372*^9}, {3.515142423399314*^9, 
   3.5151424643805857`*^9}, {3.5151439615926113`*^9, 
   3.5151440469634943`*^9}, {3.515144150712428*^9, 3.515144218908329*^9}, {
   3.51514494781802*^9, 3.5151451709637833`*^9}, {3.5151460656419563`*^9, 
   3.515146075185502*^9}, 3.5151462186937103`*^9, {3.5151462862495737`*^9, 
   3.5151462913418655`*^9}, {3.5151463231446843`*^9, 3.5151463233246946`*^9}, 
   3.515146408936591*^9, {3.515207442009861*^9, 3.515207850289213*^9}, {
   3.5152079306658106`*^9, 3.515207936842164*^9}, {3.515207967805935*^9, 
   3.515207993337395*^9}, {3.5152080386639876`*^9, 3.515208301472019*^9}, {
   3.515216708901482*^9, 3.515216768558894*^9}, {3.5152169702254286`*^9, 
   3.515216979078935*^9}, {3.515217094659546*^9, 3.51521711798288*^9}, {
   3.5152919634981627`*^9, 3.5152921729071403`*^9}, {3.5152922147195315`*^9, 
   3.515292284399517*^9}, {3.5152923305641575`*^9, 3.5152923900305586`*^9}, {
   3.515292524988278*^9, 3.5152925830025964`*^9}, {3.5152926252010098`*^9, 
   3.515292956717972*^9}, {3.5152930377476063`*^9, 3.515293642629204*^9}, {
   3.5152943602202473`*^9, 3.515294367622671*^9}, 3.5152944517104807`*^9, {
   3.5152945131059923`*^9, 3.515294513476013*^9}, 3.515294766167466*^9, 
   3.51529498512799*^9, {3.515295073857065*^9, 3.5152950857477455`*^9}, {
   3.5152954298134246`*^9, 3.515295429960433*^9}, {3.515295626022647*^9, 
   3.515295634795149*^9}, {3.5152957555590563`*^9, 3.515295770415906*^9}, 
   3.515311771680126*^9, {3.5153120561833982`*^9, 3.51531206110268*^9}, {
   3.515315380512539*^9, 3.515315397080487*^9}, {3.5153203496267567`*^9, 
   3.5153203558771143`*^9}, {3.5154065203816423`*^9, 3.515406524898901*^9}, {
   3.515725599454426*^9, 3.515725639632724*^9}, {3.515725733912116*^9, 
   3.5157257480509253`*^9}, {3.5157257914544077`*^9, 3.5157258833826656`*^9}, 
   3.515725919760746*^9, {3.5157259632782354`*^9, 3.515725967154457*^9}, {
   3.5157261970996094`*^9, 3.5157262171047535`*^9}, {3.522739583462597*^9, 
   3.522739599635209*^9}, {3.522752173448267*^9, 3.522752184108143*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5147117188298516`*^9, 3.514711720089924*^9}, {
  3.5147128277902803`*^9, 3.514712828915345*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Underlying MRA", "Section",
 CellChangeTimes->{{3.514608822135915*^9, 3.514608826626172*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"degree", " ", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regularity", " ", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"degree", "+", "1"}], ")"}], "/", "regularity"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", " ", "=", " ", 
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"L", "-", "1"}], "]"}], "/", 
     RowBox[{"Log", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{"2", "^", 
    RowBox[{"(", 
     RowBox[{"-", "q"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"regularity", "*", 
    RowBox[{"2", "^", "q"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", "i_", "]"}], " ", "=", " ", 
   RowBox[{"h", "*", 
    RowBox[{"Ceiling", "[", 
     RowBox[{"i", "/", "regularity"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"knots", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"t", "[", 
      RowBox[{"s", "-", "degree", "-", "1", "+", "i"}], "]"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "R"}], "}"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"degree", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", "0", "]"}], "[", "x_", "]"}], " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"x", "\[GreaterEqual]", 
             RowBox[{"knots", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{"x", " ", "<", " ", 
             RowBox[{"knots", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]}]}], "}"}], "}"}], 
        ",", "0"}], "]"}], "      ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "knots", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"knots", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bsupp", "[", "0", "]"}], " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Interval", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"knots", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"knots", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "knots", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"knots", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"b", "[", "k", "]"}], "[", "x_", "]"}], " ", "=", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "k"}]}], "]"}], "]"}], "-", 
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], " ", 
              "\[Equal]", " ", "0"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", 
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "k"}]}], "]"}], "]"}], "-", 
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}]}]}], "]"}], 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"k", "-", "1"}], "]"}], "[", "x", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "k", "+", "1"}]}], "]"}], "]"}], "-", 
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ")"}], " ", 
              "\[Equal]", " ", "0"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "k", "+", "1"}]}], "]"}], "]"}], "-", 
                "x"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "k", "+", "1"}]}], "]"}], "]"}], "-", 
                RowBox[{"knots", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
            "]"}], 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"k", "-", "1"}], "]"}], "[", "x", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "knots", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"knots", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "k", "-", "1"}]}], 
          "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"bsupp", "[", "k", "]"}], " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"knots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "k"}]}], "]"}], "]"}], "-", 
              RowBox[{"knots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], " ", 
            "\[Equal]", " ", "0"}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"knots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "k", "+", "1"}]}], "]"}], "]"}], "-", 
              RowBox[{"knots", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ")"}], " ", 
            "\[Equal]", " ", "0"}]}], ",", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"bsupp", "[", 
                RowBox[{"k", "-", "1"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"bsupp", "[", 
                RowBox[{"k", "-", "1"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"knots", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "k"}]}], "]"}], "]"}], "-", 
               RowBox[{"knots", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], " ", 
             "\[Equal]", " ", "0"}], " ", ",", 
            RowBox[{
             RowBox[{"bsupp", "[", 
              RowBox[{"k", "-", "1"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"knots", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "k", "+", "1"}]}], "]"}], "]"}], "-", 
                 RowBox[{"knots", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ")"}], " ", 
               "\[Equal]", " ", "0"}], " ", ",", 
              RowBox[{
               RowBox[{"bsupp", "[", 
                RowBox[{"k", "-", "1"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", ",", 
              RowBox[{"IntervalUnion", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bsupp", "[", 
                  RowBox[{"k", "-", "1"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"bsupp", "[", 
                  RowBox[{"k", "-", "1"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "knots", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"knots", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "k", "-", "1"}]}], 
         "}"}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "degree"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MRAbasis", "[", "x_", "]"}], " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"b", "[", "degree", "]"}], "[", "x", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"b", "[", "degree", "]"}], "[", "x", "]"}], "]"}]}], "}"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MRAbasissupp", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"bsupp", "[", "degree", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"bsupp", "[", "degree", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isrefined", " ", "=", " ", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"MRAbasis", "[", "x", "]"}], "]"}], "\[LessEqual]", "3"}], 
      ",", 
      RowBox[{
       RowBox[{"isrefined", " ", "=", " ", "True"}], ";", " ", 
       RowBox[{
        RowBox[{"MRAbasis", "[", "x_", "]"}], " ", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"Sqrt", "[", "2", "]"}], 
            RowBox[{"MRAbasis", "[", 
             RowBox[{"2", "x"}], "]"}]}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"Sqrt", "[", "2", "]"}], 
            RowBox[{"MRAbasis", "[", 
             RowBox[{
              RowBox[{"2", "x"}], "-", "1"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       RowBox[{"MRAbasissupp", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{"(", "MRAbasissupp", ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{"MRAbasissupp", " ", "+", " ", 
             RowBox[{"Interval", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}]}], ")"}]}]}], "]"}]}]}], 
      ",", 
      RowBox[{
       RowBox[{"MRAbasis", "[", "x_", "]"}], " ", "=", " ", 
       RowBox[{"MRAbasis", "[", "x", "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.5147162034903593`*^9, {3.514882747677147*^9, 3.5148827477231493`*^9}, {
   3.514882859349534*^9, 3.5148828595375447`*^9}, {3.515389207402397*^9, 
   3.515389208947485*^9}, {3.515389271151043*^9, 3.515389271416058*^9}, {
   3.515391754336073*^9, 3.515391762379533*^9}, {3.515392388716357*^9, 
   3.515392390664469*^9}, {3.5153929460612354`*^9, 3.515392948217359*^9}, 
   3.515392999595298*^9, {3.5153930369564342`*^9, 3.5153930387745385`*^9}, {
   3.5154069949667873`*^9, 3.5154069970159044`*^9}, {3.5157322129876986`*^9, 
   3.5157322157218547`*^9}, {3.5157326612353363`*^9, 3.515732663406461*^9}, {
   3.5157332798037167`*^9, 3.5157333031210504`*^9}, {3.5157336284576583`*^9, 
   3.5157336322608757`*^9}}],

Cell[BoxData[{
 RowBox[{"MRAbasisPW", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tl", "  ", "=", " ", 
      RowBox[{
       RowBox[{"PiecewiseExpand", "[", 
        RowBox[{
         RowBox[{"MRAbasis", "[", "x", "]"}], "[", 
         RowBox[{"[", "k", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MRAbasisPW", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], ",", 
          RowBox[{"Sort", "[", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"tl", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"tl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "NumberQ"}], "]"}], "]"}]}], "}"}], "  ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "tl", "]"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"MRAbasis", "[", "x", "]"}], "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PWTPlot", "[", 
  RowBox[{"MRAbasisPW", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5146089914195976`*^9, 3.514609010662698*^9}, {
  3.514609430594717*^9, 3.5146094921682386`*^9}, {3.5146095471643844`*^9, 
  3.5146096231967335`*^9}, {3.5146097411114774`*^9, 3.5146097471098204`*^9}, {
  3.5146100479600277`*^9, 3.514610163702648*^9}, {3.514610221971981*^9, 
  3.514610287097706*^9}, {3.514610319778575*^9, 3.514610549347706*^9}, {
  3.5146106984892364`*^9, 3.5146107035845275`*^9}, {3.5146107878173456`*^9, 
  3.514610795135764*^9}, {3.5146192293461733`*^9, 3.51461923627957*^9}, {
  3.514619345344808*^9, 3.5146193488150063`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Splitting in Parts", "Section",
 CellChangeTimes->{{3.514612982843894*^9, 3.5146129996138535`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"boundaryparts", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"MRAbasisPW", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ">", "0"}], " ", 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV0", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"MRAbasisPW", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], "==", "0"}], " ", 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refMRA", " ", "=", " ", 
   RowBox[{"PWTScale", "[", "MRAbasisPW", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV1", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"refMRA", ",", 
       RowBox[{"PWTShift", "[", 
        RowBox[{"refMRA", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], "==", "0"}], " ", 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV1symm", " ", "=", " ", 
   RowBox[{"PWTSymmetrize", "[", "AV1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV0symm", " ", "=", " ", 
   RowBox[{"PWTSymmetrize", "[", "AV0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV0no", " ", "=", " ", 
   RowBox[{"PWTOrthogonalize", "[", 
    RowBox[{"AV0symm", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV1no", " ", "=", " ", 
   RowBox[{"PWTOrthogonalize", "[", 
    RowBox[{"AV1symm", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundarysymm", " ", "=", " ", 
   RowBox[{"PWTSymmetrize", "[", "boundaryparts", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C0help", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"PWProd", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
       RowBox[{"boundarysymm", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "boundarysymm", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1help", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"PWProd", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
       RowBox[{"PWShift", "[", 
        RowBox[{
         RowBox[{"boundarysymm", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], "  ", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "boundarysymm", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C0no", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"C0help", ",", "AV0no", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1no", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"C1help", ",", "AV0no", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AV1AV0no", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"AV1no", ",", "AV0no", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cfunsno", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"boundarysymm", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"AV0no", ",", 
       RowBox[{"PWTShift", "[", 
        RowBox[{"AV0no", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.514613007153284*^9, 3.5146131113912463`*^9}, {
   3.5146131891806955`*^9, 3.51461325238031*^9}, {3.514613876268995*^9, 
   3.5146139171763344`*^9}, {3.514613963310973*^9, 3.5146140043803225`*^9}, 
   3.514621459356723*^9, {3.5146216160396843`*^9, 3.51462180670759*^9}, {
   3.514622007346066*^9, 3.5146222041723237`*^9}, {3.5146255603592863`*^9, 
   3.514625595014269*^9}, {3.5146349774655347`*^9, 3.5146349812727523`*^9}, {
   3.5146361063191013`*^9, 3.514636187728758*^9}, {3.514691578917915*^9, 
   3.5146915855092916`*^9}, {3.5146926544824333`*^9, 
   3.5146926546484427`*^9}, {3.514692708563527*^9, 3.5146927648307447`*^9}, 
   3.514693793845601*^9, {3.5146985590451555`*^9, 3.5146985783182573`*^9}, {
   3.514722575466689*^9, 3.5147226584094334`*^9}, {3.514722715291687*^9, 
   3.514722738287002*^9}, {3.5147238579810452`*^9, 3.51472386104922*^9}, {
   3.5147238946591425`*^9, 3.514724004525427*^9}, {3.5147240415595455`*^9, 
   3.514724086611122*^9}, {3.51472453660186*^9, 3.5147245600392003`*^9}, {
   3.514724612074177*^9, 3.5147246426979284`*^9}, 3.514725019239465*^9, {
   3.514725772664559*^9, 3.5147257886594734`*^9}, {3.5147258709181786`*^9, 
   3.514725906802231*^9}, {3.514726105119574*^9, 3.5147261154441643`*^9}, 
   3.5147262040582333`*^9, {3.5147266316276884`*^9, 3.5147266827676134`*^9}, {
   3.5147267465482616`*^9, 3.514726764498288*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Choose additional functions in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "(", 
    SubscriptBox["V", "1"], ")"}], TraditionalForm]], "None"],
 " \[CircleMinus] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "(", 
    SubscriptBox["V", "0"], ")"}], TraditionalForm]], "None"]
}], "Section",
 CellChangeTimes->{3.5147268280559235`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "k"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nor", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"coeff", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}]}], "]"}], "   ", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intC0", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"C0no", ",", "AV1AV0no", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intC1", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"C1no", ",", "AV1AV0no", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"C0no", ",", "C1no", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqns", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"intC0", "[", 
               RowBox[{"[", "mu", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], 
             RowBox[{
              RowBox[{"coeff", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], 
             RowBox[{
              RowBox[{"coeff", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "l", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"intC1", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "l", "]"}], "]"}], "/", 
              RowBox[{"nor", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "   ", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "1", ",", 
              RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], "-", 
          RowBox[{"rhs", "[", 
           RowBox[{"[", 
            RowBox[{"mu", ",", "nu"}], "]"}], "]"}]}], ")"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"mu", ",", "1", ",", 
         RowBox[{"Length", "[", "C0no", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nu", ",", "1", ",", 
         RowBox[{"Length", "[", "C1no", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "a", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"i", ",", "j"}], "]"}], " ", "=", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", "/.", " ", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"i", ",", "mu"}], "]"}], 
              RowBox[{"a", "[", 
               RowBox[{"j", ",", "mu"}], "]"}]}], "   ", ",", 
             RowBox[{"{", 
              RowBox[{"mu", ",", "1", ",", 
               RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}]}], "]"}], 
           "\[Equal]", "0"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"k", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"i", "+", "1"}], ",", "k"}], "}"}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clisthelp", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"k", "-", "1"}]}], " ", "&&", " ", 
          RowBox[{"j", " ", "\[GreaterEqual]", 
           RowBox[{"i", "+", "1"}]}], " ", "&&", " ", 
          RowBox[{"j", "\[LessEqual]", "k"}]}], "  ", ",", "0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], 
           RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "+", "j"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}]}], "]"}], ",", 
     "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clistidx", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"clisthelp", ",", " ", 
     RowBox[{
      RowBox[{"#", " ", ">", "0"}], " ", "&"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clisth", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"coeff", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clist", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"clisth", "[", 
      RowBox[{"[", 
       RowBox[{"clistidx", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "clistidx", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"FindMinimum", "[", 
   RowBox[{"eqns", ",", "clist", ",", 
    RowBox[{"MaxIterations", "\[Rule]", "20000"}], ",", 
    RowBox[{"WorkingPrecision", "\[Rule]", "1100"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5147753247376986`*^9, 3.5147753304610257`*^9}, {
   3.5147753666650963`*^9, 3.5147753752645884`*^9}, {3.5147754292656765`*^9, 
   3.5147754466946735`*^9}, {3.5147755336886497`*^9, 3.514775597261286*^9}, {
   3.5147774606708665`*^9, 3.5147774830131445`*^9}, {3.5147784914098215`*^9, 
   3.5147786771894474`*^9}, {3.5147787397290244`*^9, 
   3.5147787402150526`*^9}, {3.514779081536575*^9, 3.5147791785651245`*^9}, {
   3.514779722961262*^9, 3.514779875959013*^9}, {3.514779917351381*^9, 
   3.5147799214216137`*^9}, 3.514780606051772*^9, {3.5147806797669888`*^9, 
   3.514780690840622*^9}, {3.5147807245585504`*^9, 3.5147807476588717`*^9}, {
   3.5147807950785837`*^9, 3.514780812812598*^9}, {3.514782015569392*^9, 
   3.514782052290492*^9}, 3.5147821978598185`*^9, {3.514782234741928*^9, 
   3.514782294363338*^9}, {3.5147823605081215`*^9, 3.514782380277252*^9}, {
   3.5147824157152786`*^9, 3.5147825281997128`*^9}, {3.5147826159657326`*^9, 
   3.514782642336241*^9}, {3.5147828675391216`*^9, 3.5147829545480986`*^9}, {
   3.514783040486014*^9, 3.514783122161685*^9}, {3.5147832378943048`*^9, 
   3.514783243941651*^9}, {3.5147834328944583`*^9, 3.514783483676363*^9}, {
   3.5147835355963326`*^9, 3.5147836805526237`*^9}, 3.514785253521592*^9, 
   3.5147856406447344`*^9, {3.5148091996085005`*^9, 3.514809199697506*^9}, {
   3.515389280859598*^9, 3.515389281008607*^9}, {3.515391775510284*^9, 
   3.515391775659292*^9}, {3.5153923998619947`*^9, 3.515392400727044*^9}, {
   3.515392971150671*^9, 3.5153930224986076`*^9}, {3.5153930702453384`*^9, 
   3.5153930702973413`*^9}, {3.5154073836180167`*^9, 
   3.5154073841220455`*^9}, {3.51573141297094*^9, 3.5157314136769805`*^9}, {
   3.5157322413133183`*^9, 3.515732241469327*^9}, {3.5157328481510277`*^9, 
   3.5157328482710342`*^9}, {3.5157330854526005`*^9, 3.515733085832622*^9}, {
   3.5157333158537784`*^9, 3.515733321877123*^9}, {3.5157337340766993`*^9, 
   3.515733735118759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solcoeff", " ", "=", " ", 
   RowBox[{"coeff", " ", "/.", " ", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.514784707752376*^9, 3.514784769826926*^9}, {
  3.5147863575767403`*^9, 3.5147863728896165`*^9}, {3.5147864608446474`*^9, 
  3.51478648502703*^9}, {3.514786517752902*^9, 3.5147865202070427`*^9}, {
  3.51478659272519*^9, 3.5147866185506673`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ws", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"PWTSum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PWFactor", "[", 
          RowBox[{
           RowBox[{"AV1AV0no", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"solcoeff", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "   ", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "AV1AV0no", "]"}]}], "}"}]}], "   ", "]"}], 
     " ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wsorth", " ", "=", " ", 
   RowBox[{"PWTNormalize", "[", 
    RowBox[{"ws", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTPlot", "[", 
   RowBox[{"wsorth", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PWTOrthTest", "[", 
  RowBox[{"wsorth", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5147848319164777`*^9, 3.5147848559678535`*^9}, {
   3.514785023348427*^9, 3.5147851324346666`*^9}, 3.5147852612310333`*^9, {
   3.5147854959714594`*^9, 3.514785569360657*^9}, {3.5147856094579506`*^9, 
   3.5147856312331963`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Orthogonalize with C0 functions and build basis", "Section",
 CellChangeTimes->{
  3.514785681710083*^9, {3.514785978032032*^9, 3.5147859848134193`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"addfunsno", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"Cfunsno", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"wsorth", ",", 
       RowBox[{"PWTShift", "[", 
        RowBox[{"wsorth", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "10"}], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basis", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"AV0no", ",", "wsorth", ",", "addfunsno"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PWTOrthTest", "[", 
  RowBox[{"addfunsno", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"PWTIntProd", "[", 
     RowBox[{"basis", ",", "basis", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "10"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"PWTIntProd", "[", 
     RowBox[{"basis", ",", 
      RowBox[{"PWTShift", "[", 
       RowBox[{"basis", ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "10"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"PWTIntProd", "[", 
     RowBox[{"basis", ",", 
      RowBox[{"PWTShift", "[", 
       RowBox[{"basis", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "10"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.514785852762867*^9, 3.514785942250985*^9}, {
  3.514785991775818*^9, 3.5147860310720654`*^9}, {3.514786072360427*^9, 
  3.514786125842486*^9}, {3.5147866283832293`*^9, 3.5147866592529955`*^9}, {
  3.514786691098817*^9, 3.51478669149984*^9}, {3.514787170311226*^9, 
  3.514787188001238*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wavelet construction", "Section",
 CellChangeTimes->{{3.514786745861949*^9, 3.514786752432325*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eps", " ", "=", " ", 
   RowBox[{"10", "^", 
    RowBox[{"-", "50"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q0", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"basis", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], " ", ">", " ", 
       "eps"}], " ", "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q1", " ", "=", " ", 
   RowBox[{"PWTScale", "[", "Q0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AS0", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"basis", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], " ", "<=", " ", 
       "eps"}], " ", "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refbasis", " ", "=", " ", 
   RowBox[{"PWTScale", "[", "basis", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AS1", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"refbasis", ",", 
       RowBox[{"PWTShift", "[", 
        RowBox[{"refbasis", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], " ", "<=", " ", 
       "eps"}], " ", "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AS1AS0no", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"AS1", ",", "AS0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsiS", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"Q1", ",", "Q0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsiAhelp1", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"Q0", ",", "Q1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsiAhelp2", " ", "=", " ", 
   RowBox[{"PWTOrthogonalize", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"PWTSum", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PWProject", "[", 
            RowBox[{
             RowBox[{"Q0", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"AS1AS0no", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "AS1AS0no", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "AS1AS0no", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "Q0", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsiA", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", " ", 
    RowBox[{"PsiAhelp2", ",", "PsiAhelp1", ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q0Join", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"Q0", ",", 
     RowBox[{"PWTShift", "[", 
      RowBox[{"Q0", ",", "1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsiRhelp1", " ", "=", " ", 
   RowBox[{"PWTOrthogonalize", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"PWTSum", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PWProject", "[", 
            RowBox[{
             RowBox[{"Q0Join", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"AS1AS0no", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "AS1AS0no", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "AS1AS0no", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "Q0Join", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PsiR", " ", "=", " ", 
   RowBox[{"PWTOrthogonalizeWR2", "[", 
    RowBox[{"AS1AS0no", ",", "PsiRhelp1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavelets", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"PsiR", ",", "PsiA", ",", "PsiS"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5147868657458057`*^9, 3.514786936883875*^9}, {
   3.514786979068288*^9, 3.514787130991977*^9}, {3.514787202425063*^9, 
   3.5147872921271935`*^9}, {3.5147873489844456`*^9, 
   3.5147873497104874`*^9}, {3.514787382684373*^9, 3.514787455959564*^9}, 
   3.5147875176420927`*^9, {3.5147875684820004`*^9, 3.514787605457115*^9}, {
   3.5147880337636127`*^9, 3.514788039262927*^9}, {3.5147968750323043`*^9, 
   3.5147968942744055`*^9}, {3.5147977625850697`*^9, 3.514797856965468*^9}, 
   3.5147979346749125`*^9, 3.5147981001373763`*^9, {3.5147981320902042`*^9, 
   3.51479817975193*^9}, {3.5147982679999776`*^9, 3.514798310094385*^9}, {
   3.5147983432422814`*^9, 3.514798345552414*^9}, {3.5147983831205626`*^9, 
   3.514798440634852*^9}, {3.5147984919287853`*^9, 3.514798522687545*^9}, {
   3.5147985531992903`*^9, 3.5147986653607054`*^9}, 3.5148091025919514`*^9, 
   3.5148659743542233`*^9, {3.5148660060900383`*^9, 3.5148660277832794`*^9}, {
   3.5148660929760084`*^9, 3.5148664320754037`*^9}, 3.514866471507659*^9, {
   3.514867115011465*^9, 3.5148671393948603`*^9}, {3.514867171678706*^9, 
   3.5148671815412703`*^9}, {3.5148672117349977`*^9, 3.514867270435355*^9}, 
   3.5148742970117965`*^9, {3.514874334433937*^9, 3.514874389058061*^9}, {
   3.5148744318075066`*^9, 3.514874617603133*^9}, {3.5148746546082497`*^9, 
   3.5148746908313217`*^9}, {3.514874725207288*^9, 3.5148747957463226`*^9}, {
   3.514878672533062*^9, 3.514878875271658*^9}, {3.514878932880953*^9, 
   3.514878939614338*^9}, {3.514879100966567*^9, 3.514879115957424*^9}, {
   3.514880675459623*^9, 3.5148806816469765`*^9}, {3.5151319553870296`*^9, 
   3.5151319872422857`*^9}, {3.515407670257412*^9, 3.5154076916206336`*^9}, {
   3.515471530736636*^9, 3.5154715395071383`*^9}, {3.5154720052637777`*^9, 
   3.5154721693411627`*^9}, {3.5154723522536244`*^9, 3.515472355973837*^9}, {
   3.515472400053358*^9, 3.51547242560682*^9}, {3.5154724606888266`*^9, 
   3.515472473097536*^9}, {3.515472511485732*^9, 3.5154725368591833`*^9}, {
   3.515472607170205*^9, 3.515472616019711*^9}, {3.5154727980461226`*^9, 
   3.515472802180359*^9}, {3.515472895649705*^9, 3.515472914313772*^9}, {
   3.5154792769856963`*^9, 3.5154792895544157`*^9}, {3.515483426075011*^9, 
   3.515483489773654*^9}, 3.5157257617687097`*^9, {3.515731465742958*^9, 
   3.515731514589752*^9}}],

Cell[BoxData[{
 RowBox[{"PWTPlot", "[", 
  RowBox[{"wavelets", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erg1", " ", "=", " ", 
   RowBox[{"PWTOrthTest", "[", 
    RowBox[{"wavelets", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erg2", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"wavelets", ",", 
     RowBox[{"PWTShift", "[", 
      RowBox[{"wavelets", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erg3", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"wavelets", ",", 
     RowBox[{"PWTShift", "[", 
      RowBox[{"wavelets", ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erg4", "  ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"wavelets", ",", "basis", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erg5", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"wavelets", ",", 
     RowBox[{"PWTShift", "[", 
      RowBox[{"basis", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erg6", " ", "=", " ", 
   RowBox[{"PWTIntProd", "[", 
    RowBox[{"wavelets", ",", 
     RowBox[{"PWTShift", "[", 
      RowBox[{"basis", ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxerror", " ", "=", " ", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"erg1", ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "1"}], " ", "&"}]}], 
      "]"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"erg2", ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "1"}], " ", "&"}]}], 
      "]"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"erg3", ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "1"}], " ", "&"}]}], 
      "]"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"erg4", ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "1"}], " ", "&"}]}], 
      "]"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"erg5", ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "1"}], " ", "&"}]}], 
      "]"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"erg6", ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "1"}], " ", "&"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Error \>\"", ",", "maxerror"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"erg1", ",", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"erg2", ",", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"erg3", ",", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"erg4", ",", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"erg5", ",", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"erg6", ",", "5"}], "]"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.514880689556429*^9, 3.5148808840675545`*^9}, 
   3.5148813103329353`*^9, {3.5151435676900816`*^9, 3.5151435831529655`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dirichlet Boundary ", "Section",
 CellChangeTimes->{{3.514887663102293*^9, 3.514887671648782*^9}, {
   3.514887871400207*^9, 3.51488790240098*^9}, 3.5148880504634485`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dbsl", " ", "=", " ", 
   RowBox[{"PWTDirichlet", "[", 
    RowBox[{"addfunsno", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbsr", " ", "=", " ", 
   RowBox[{"PWTDirichlet", "[", 
    RowBox[{
     RowBox[{"PWTShift", "[", 
      RowBox[{"addfunsno", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"overlappingWavelets", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"wavelets", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PWIntegrate", "[", 
        RowBox[{
         RowBox[{"PWProd", "[", 
          RowBox[{"#", ",", "#"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], " ", ">", " ", 
       "eps"}], " ", "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbwlhelp", " ", "=", " ", 
   RowBox[{"PWTDirichlet", "[", 
    RowBox[{"overlappingWavelets", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbwl", " ", "=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "dbsl", "]"}], ">", "0"}], ",", 
     RowBox[{"PWTOrthogonalizeWR2", "[", 
      RowBox[{"dbwlhelp", ",", "dbsl", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}], ",", 
     "dbwlhelp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbwrhelp", " ", "=", " ", 
   RowBox[{"PWTDirichlet", "[", 
    RowBox[{
     RowBox[{"PWTShift", "[", 
      RowBox[{"overlappingWavelets", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbwr", " ", "=", "  ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "dbsr", "]"}], ">", "0"}], ",", 
     RowBox[{"PWTOrthogonalizeWR2", "[", 
      RowBox[{"dbwrhelp", ",", "dbsr", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "eps"}], "]"}], ",", 
     "dbwrhelp"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.515131549224716*^9, 3.515131554856326*^9}, {
  3.5151316030760107`*^9, 3.5151318276696053`*^9}, {3.515131859805662*^9, 
  3.5151318653904715`*^9}, {3.51513200672672*^9, 3.515132062559218*^9}, {
  3.5151321477041674`*^9, 3.515132166081*^9}, {3.5151325042739935`*^9, 
  3.515132514242411*^9}, {3.515386655357428*^9, 3.5153867373131156`*^9}, {
  3.5153867716730804`*^9, 3.51538680574703*^9}, {3.5153881583883963`*^9, 
  3.515388158881425*^9}, {3.5153896136856346`*^9, 3.5153896970994053`*^9}}],

Cell[BoxData[{
 RowBox[{"PWTPlot", "[", 
  RowBox[{"dbsl", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PWTPlot", "[", 
  RowBox[{"dbsr", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PWTPlot", "[", 
  RowBox[{"dbwl", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PWTPlot", "[", 
  RowBox[{"dbwr", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5151325907449455`*^9, 3.515132625002606*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["C++ Code", "Section",
 CellChangeTimes->{{3.5151326322722187`*^9, 3.5151326342222223`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"digits", " ", ":=", " ", "40"}], ";", 
  RowBox[{"name", " ", "=", " ", "\"\<octic\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cppstringbspline", " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"cppstringbspline", " ", "=", " ", 
    RowBox[{"cppstringbspline", " ", "<>", " ", 
     RowBox[{"PWPrintFun", "[", 
      RowBox[{
       RowBox[{"basis", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "name", ",", "\"\<bspline\>\"", 
       ",", "\"\<inner\>\"", ",", 
       RowBox[{"i", "-", "1"}], ",", "\"\<value\>\"", ",", "digits"}], "]"}], 
     "<>", "\"\<\\n\\n\\n\>\""}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "basis", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"cppstringbspline", " ", "=", " ", 
    RowBox[{"cppstringbspline", " ", "<>", " ", 
     RowBox[{"PWPrintFun", "[", 
      RowBox[{
       RowBox[{"dbsl", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "name", ",", "\"\<bspline\>\"", 
       ",", "\"\<left\>\"", ",", 
       RowBox[{"i", "-", "1"}], ",", "\"\<value\>\"", ",", "digits"}], "]"}], 
     "<>", "\"\<\\n\\n\\n\>\""}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "dbsl", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"cppstringbspline", " ", "=", " ", 
    RowBox[{"cppstringbspline", " ", "<>", " ", 
     RowBox[{"PWPrintFun", "[", 
      RowBox[{
       RowBox[{"dbsr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "name", ",", "\"\<bspline\>\"", 
       ",", "\"\<right\>\"", ",", 
       RowBox[{"i", "-", "1"}], ",", "\"\<value\>\"", ",", "digits"}], "]"}], 
     "<>", "\"\<\\n\\n\\n\>\""}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "dbsr", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cppstringwavelet", " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"cppstringwavelet", " ", "=", " ", 
    RowBox[{"cppstringwavelet", " ", "<>", " ", 
     RowBox[{"PWPrintFun", "[", 
      RowBox[{
       RowBox[{"wavelets", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "name", ",", "\"\<wavelet\>\"", 
       ",", "\"\<inner\>\"", ",", 
       RowBox[{"i", "-", "1"}], ",", "\"\<value\>\"", ",", "digits"}], "]"}], 
     "<>", "\"\<\\n\\n\\n\>\""}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "wavelets", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"cppstringwavelet", " ", "=", " ", 
    RowBox[{"cppstringwavelet", " ", "<>", " ", 
     RowBox[{"PWPrintFun", "[", 
      RowBox[{
       RowBox[{"dbwl", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "name", ",", "\"\<wavelet\>\"", 
       ",", "\"\<left\>\"", ",", 
       RowBox[{"i", "-", "1"}], ",", "\"\<value\>\"", ",", "digits"}], "]"}], 
     "<>", "\"\<\\n\\n\\n\>\""}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "dbwl", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"cppstringwavelet", " ", "=", " ", 
    RowBox[{"cppstringwavelet", " ", "<>", " ", 
     RowBox[{"PWPrintFun", "[", 
      RowBox[{
       RowBox[{"dbwr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "name", ",", "\"\<wavelet\>\"", 
       ",", "\"\<right\>\"", ",", 
       RowBox[{"i", "-", "1"}], ",", "\"\<value\>\"", ",", "digits"}], "]"}], 
     "<>", "\"\<\\n\\n\\n\>\""}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "dbwr", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpptext", " ", "=", " ", 
   RowBox[{
   "cppstringbspline", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
    "cppstringwavelet", " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
    RowBox[{"setEvaluatorLeft", "[", 
     RowBox[{"dbsl", ",", "basis", ",", "name", ",", "\"\<bspline\>\""}], 
     "]"}], " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
    RowBox[{"setEvaluatorInner", "[", 
     RowBox[{"basis", ",", "name", ",", "\"\<bspline\>\""}], "]"}], " ", "<>",
     " ", "\"\<\\n\>\"", " ", "<>", " ", 
    RowBox[{"setEvaluatorRight", "[", 
     RowBox[{"dbsr", ",", "name", ",", "\"\<bspline\>\""}], "]"}], " ", "<>", 
    " ", "\"\<\\n\>\"", " ", "<>", " ", 
    RowBox[{"setEvaluatorLeft", "[", 
     RowBox[{"dbwl", ",", "wavelets", ",", "name", ",", "\"\<wavelet\>\""}], 
     "]"}], " ", "<>", " ", "\"\<\\n\>\"", " ", "<>", " ", 
    RowBox[{"setEvaluatorInner", "[", 
     RowBox[{"wavelets", ",", "name", ",", "\"\<wavelet\>\""}], "]"}], " ", "<>",
     " ", "\"\<\\n\>\"", " ", "<>", " ", 
    RowBox[{"setEvaluatorRight", "[", 
     RowBox[{"dbwr", ",", "name", ",", "\"\<wavelet\>\""}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"file", " ", "=", " ", 
  RowBox[{"OpenWrite", "[", 
   RowBox[{
    RowBox[{
    "$HomeDirectory", "<>", 
     "\"\</LAWA/lawa/constructions/multi/mathematica/cpp/\>\"", "<>", "name", 
     "<>", "\"\<.cpp\>\""}], ",", 
    RowBox[{"PageWidth", "\[Rule]", "1000"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"file", ",", 
    RowBox[{"TextForm", "[", "cpptext", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Close", "[", "file", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5151424971094437`*^9, 3.515142504160656*^9}, {
   3.5151430881566534`*^9, 3.5151432687179813`*^9}, {3.5151433005418015`*^9, 
   3.5151434919687505`*^9}, {3.515143606613308*^9, 3.5151436509908457`*^9}, {
   3.515144094593219*^9, 3.5151441021446505`*^9}, 3.515145180802346*^9, {
   3.5151473971151123`*^9, 3.5151475448905644`*^9}, {3.5151476263742247`*^9, 
   3.5151478540432467`*^9}, {3.515147898653798*^9, 3.515147911376526*^9}, {
   3.5151479549370174`*^9, 3.5151480036828055`*^9}, {3.515209344839697*^9, 
   3.51520951116821*^9}, {3.515209632081126*^9, 3.5152096797238507`*^9}, {
   3.51520972866965*^9, 3.5152097481977673`*^9}, {3.515209897863328*^9, 
   3.5152099035036507`*^9}, {3.515209986128769*^9, 3.5152099889679737`*^9}, {
   3.515210034166846*^9, 3.5152100475196676`*^9}, {3.5152100804013233`*^9, 
   3.5152101022101617`*^9}, {3.515210146313475*^9, 3.515210209290786*^9}, {
   3.5152103697038736`*^9, 3.515210394507917*^9}, {3.515389363556328*^9, 
   3.5153893643663745`*^9}, {3.515391917252391*^9, 3.5153919223446827`*^9}, {
   3.515392427135555*^9, 3.515392427828594*^9}, {3.5153931234243803`*^9, 
   3.515393130550788*^9}, {3.5157323267802067`*^9, 3.515732330473418*^9}, {
   3.515732917628001*^9, 3.51573291900008*^9}, {3.5157333862858067`*^9, 
   3.5157333867298326`*^9}, {3.5157337712688265`*^9, 
   3.5157337727339106`*^9}, {3.522739612430005*^9, 3.522739649418*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Latex Output", "Section",
 CellChangeTimes->{{3.515210603723482*^9, 3.5152106073426886`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</LAWA/lawa/constructions/multi/mathematica/tex/\>\"", "<>", "name"}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{
    RowBox[{"Directory", "[", "]"}], "<>", "\"\</\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basisnum", " ", "=", " ", 
   RowBox[{"PWTSimplify", "[", 
    RowBox[{"basis", ",", "digits"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{
   "\"\<\\\\documentclass{article}\\n\\n\\\\usepackage{amsmath, amsthm, \
amssymb}\\n\\\\usepackage{geometry}\n\\\\geometry{a4paper, top=25mm, \
left=10mm, right=10mm, bottom=30mm,\nheadsep=10mm, \
footskip=12mm}\\n\\\\usepackage{graphicx}\\n\\\\usepackage{lscape}\\n\\\\\
begin{document} \\n\\n\\\\begin{landscape}\\n\\\\section{\>\"", "<>", "name", 
    " ", "<>", 
    "\"\< BSplines}\\n\\\\subsection{Functions}\\\\begin{eqnarray*} \>\""}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexFunctions", "[", 
     RowBox[{"basisnum", ",", "\"\<\\\\varphi_\>\"", ",", "\"\<\>\""}], "]"}],
     " ", "<>", " ", 
    "\"\<\\\\end{eqnarray*}\\n\\\\end{landscape}\\n\\\\begin{landscape}\\n\\\\\
subsection{Graphics}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTExportGraphics", "[", 
   RowBox[{"path", ",", "name", ",", "\"\<bspline\>\"", ",", "basisnum", ",", 
    RowBox[{"PWTGetPlotRanges", "[", "basisnum", "]"}], ",", "\[CurlyPhi]"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexGraphicTable", "[", 
     RowBox[{"basisnum", ",", "name", ",", "\"\<bspline\>\""}], "]"}], " ", 
    "<>", "\"\< \\\\end{landscape}\\n \\\\begin{landscape}\\n \
\\\\subsection{Validation}\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexValidationTable", "[", 
     RowBox[{
     "basis", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
      "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\"", ",", "\"\<\\\\varphi_\>\"", 
      ",", "\"\<(x)\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", " ", 
    RowBox[{"PWTWriteTexValidationTableV2", "[", 
     RowBox[{"basis", ",", 
      RowBox[{"PWTShift", "[", 
       RowBox[{"basis", ",", "1"}], "]"}], ",", 
      "\"\<\\\\int_{-1}^1 f_1(x)f_2(x-1) dx\>\"", ",", "\"\<\\\\varphi_\>\"", 
      ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\""}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{
   "texCode", " ", "<>", " ", 
    "\"\<\\\\end{landscape} \\n \\\\begin{landscape}\\n \\\\subsection{\>\"", 
    "<>", "name", " ", "<>", 
    "\"\< BSpline dirichlet boundary Functions}\\n \\\\begin{eqnarray*}\\n \>\
\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbslnum", " ", "=", " ", 
   RowBox[{"PWTSimplify", "[", 
    RowBox[{"dbsl", ",", "digits"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbsrnum", " ", "=", " ", 
   RowBox[{"PWTSimplify", "[", 
    RowBox[{"dbsr", ",", "digits"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexFunctions", "[", 
     RowBox[{
     "dbslnum", ",", "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", 
      "\"\<}\>\""}], "]"}], " ", "<>", " ", "\"\<\\\\\\\\ \\n\>\"", " ", "<>", 
    RowBox[{"PWTWriteTexFunctions", "[", 
     RowBox[{
     "dbsrnum", ",", "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", 
      "\"\<}\>\""}], "]"}], " ", "<>", " ", 
    "\"\<\\\\end{eqnarray*}\\n\\\\end{landscape}\\n\\\\begin{landscape}\\n\\\\\
subsection{BSpline Dirichlet boundary Graphics}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTExportGraphics", "[", 
   RowBox[{
   "path", ",", "name", ",", "\"\<bspline_dleft\>\"", ",", "dbslnum", ",", 
    RowBox[{"PWTGetPlotRanges", "[", "dbslnum", "]"}], ",", 
    SubscriptBox["\[CurlyPhi]", "left"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTExportGraphics", "[", 
   RowBox[{
   "path", ",", "name", ",", "\"\<bspline_dright\>\"", ",", "dbsrnum", ",", 
    RowBox[{"PWTGetPlotRanges", "[", "dbsrnum", "]"}], ",", 
    SubscriptBox["\[CurlyPhi]", "right"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexGraphicTable", "[", 
     RowBox[{"dbslnum", ",", "name", ",", "\"\<bspline_dleft\>\""}], "]"}], 
    "<>", "\"\< \\\\\\\\ \\n\>\""}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexGraphicTable", "[", 
     RowBox[{"dbsrnum", ",", "name", ",", "\"\<bspline_dright\>\""}], "]"}], 
    " ", "<>", 
    "\"\< \\\\end{landscape}\\n \\\\begin{landscape}\\n \
\\\\subsection{Validation}\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "dbsl", "]"}], ">", "0"}], ",", 
   RowBox[{
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTable", "[", 
       RowBox[{
       "dbsl", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{
       "dbsl", ",", "basis", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", 
        ",", "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{"dbsl", ",", 
        RowBox[{"PWTShift", "[", 
         RowBox[{"basis", ",", "1"}], "]"}], ",", 
        "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\varphi_\>\"", 
        ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\varphi_{\\\\text{left},\>\"", 
        ",", "\"\<}(x)\>\""}], "]"}]}]}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "dbsr", "]"}], ">", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTable", "[", 
       RowBox[{
       "dbsr", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{
       "dbsr", ",", "basis", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", 
        ",", "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{"dbsr", ",", 
        RowBox[{"PWTShift", "[", 
         RowBox[{"basis", ",", "1"}], "]"}], ",", 
        "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\varphi_\>\"", 
        ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\varphi_{\\\\text{right},\>\"", 
        ",", "\"\<}(x)\>\""}], "]"}]}]}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dbsl", "]"}], ">", "0"}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"Length", "[", "dbsr", "]"}], ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{
       "dbsr", ",", "dbsl", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", 
        ",", "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\"", ",", 
        "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
       "]"}]}]}], ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{
   "texCode", " ", "<>", " ", 
    "\"\<\\\\end{landscape} \\n \
\\\\begin{landscape}\\n\\\\section{Wavelets}\\n\\\\subsection{Functions}\\n \
\\\\begin{eqnarray*}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavenum", " ", "=", " ", 
   RowBox[{"PWTSimplify", "[", 
    RowBox[{"wavelets", ",", "digits"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexFunctions", "[", 
     RowBox[{"wavenum", ",", "\"\<\\\\Psi_\>\"", ",", "\"\<\>\""}], "]"}], 
    " ", "<>", " ", 
    "\"\<\\\\end{eqnarray*}\\n\\\\end{landscape}\\n\\\\begin{landscape}\\n\\\\\
subsection{Graphics}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTExportGraphics", "[", 
   RowBox[{"path", ",", "name", ",", "\"\<wavelet\>\"", ",", "wavenum", ",", 
    RowBox[{"PWTGetPlotRanges", "[", "wavenum", "]"}], ",", "\[CapitalPsi]"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexGraphicTable", "[", 
     RowBox[{"wavenum", ",", "name", ",", "\"\<wavelet\>\""}], "]"}], " ", 
    "<>", "\"\< \\\\end{landscape}\\n \\\\begin{landscape}\\n \
\\\\subsection{Validation}\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexValidationTable", "[", 
     RowBox[{
     "wavelets", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
      "\"\<\\\\Psi_\>\"", ",", "\"\<(x)\>\"", ",", "\"\<\\\\Psi_\>\"", ",", 
      "\"\<(x)\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", "  ", 
    RowBox[{"PWTWriteTexValidationTableV2", "[", 
     RowBox[{"wavelets", ",", 
      RowBox[{"PWTShift", "[", 
       RowBox[{"wavelets", ",", "1"}], "]"}], ",", 
      "\"\<\\\\int_{-1}^1 f_1(x)f_2(x-1) dx\>\"", ",", "\"\<\\\\Psi_\>\"", 
      ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\Psi_\>\"", ",", "\"\<(x)\>\""}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", "  ", 
    RowBox[{"PWTWriteTexValidationTableV2", "[", 
     RowBox[{
     "wavelets", ",", "basis", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", 
      ",", "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\"", ",", "\"\<\\\\Psi_\>\"",
       ",", "\"\<(x)\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", "  ", 
    RowBox[{"PWTWriteTexValidationTableV2", "[", 
     RowBox[{"wavelets", ",", 
      RowBox[{"PWTShift", "[", 
       RowBox[{"basis", ",", "1"}], "]"}], ",", 
      "\"\<\\\\int_{-1}^1 f_1(x)f_2(x-1) dx\>\"", ",", "\"\<\\\\varphi_\>\"", 
      ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\Psi_\>\"", ",", "\"\<(x)\>\""}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", "  ", 
    RowBox[{"PWTWriteTexValidationTableV2", "[", 
     RowBox[{"wavelets", ",", 
      RowBox[{"PWTShift", "[", 
       RowBox[{"basis", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      "\"\<\\\\int_{-1}^1 f_1(x)f_2(x+1) dx\>\"", ",", "\"\<\\\\varphi_\>\"", 
      ",", "\"\<(x+1)\>\"", ",", "\"\<\\\\Psi_\>\"", ",", "\"\<(x)\>\""}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{
   "texCode", " ", "<>", " ", 
    "\"\<\\\\end{landscape} \\n \\\\begin{landscape}\\n \\\\subsection{\>\"", 
    "<>", "name", " ", "<>", 
    "\"\< Wavelet dirichlet boundary Functions}\\n \\\\begin{eqnarray*}\\n \>\
\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbwlnum", " ", "=", " ", 
   RowBox[{"PWTSimplify", "[", 
    RowBox[{"dbwl", ",", "digits"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbwrnum", " ", "=", " ", 
   RowBox[{"PWTSimplify", "[", 
    RowBox[{"dbwr", ",", "digits"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexFunctions", "[", 
     RowBox[{
     "dbwlnum", ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}\>\""}], 
     "]"}], " ", "<>", " ", "\"\<\\\\\\\\ \\n\>\"", " ", "<>", 
    RowBox[{"PWTWriteTexFunctions", "[", 
     RowBox[{
     "dbwrnum", ",", "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}\>\""}], 
     "]"}], " ", "<>", " ", 
    "\"\<\\\\end{eqnarray*}\\n\\\\end{landscape}\\n\\\\begin{landscape}\\n\\\\\
subsection{Wavelet Dirichlet boundary Graphics}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTExportGraphics", "[", 
   RowBox[{
   "path", ",", "name", ",", "\"\<wavelet_dleft\>\"", ",", "dbwlnum", ",", 
    RowBox[{"PWTGetPlotRanges", "[", "dbwlnum", "]"}], ",", 
    SubscriptBox["\[CapitalPsi]", "left"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PWTExportGraphics", "[", 
   RowBox[{
   "path", ",", "name", ",", "\"\<wavelet_dright\>\"", ",", "dbwrnum", ",", 
    RowBox[{"PWTGetPlotRanges", "[", "dbwrnum", "]"}], ",", 
    SubscriptBox["\[CapitalPsi]", "right"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexGraphicTable", "[", 
     RowBox[{"dbwlnum", ",", "name", ",", "\"\<wavelet_dleft\>\""}], "]"}], 
    "<>", "\"\< \\\\\\\\ \\n\>\""}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texCode", " ", "=", " ", 
   RowBox[{"texCode", " ", "<>", " ", 
    RowBox[{"PWTWriteTexGraphicTable", "[", 
     RowBox[{"dbwrnum", ",", "name", ",", "\"\<wavelet_dright\>\""}], "]"}], 
    " ", "<>", 
    "\"\< \\\\end{landscape}\\n \\\\begin{landscape}\\n \
\\\\subsection{Validation}\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "dbwl", "]"}], ">", "0"}], ",", 
   RowBox[{
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTable", "[", 
       RowBox[{
       "dbwl", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
        "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\"", ",", 
        "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{
       "dbwl", ",", "basis", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", 
        ",", "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\"", ",", 
        "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{"dbwl", ",", 
        RowBox[{"PWTShift", "[", 
         RowBox[{"basis", ",", "1"}], "]"}], ",", 
        "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\varphi_\>\"", 
        ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", 
        "\"\<}(x)\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{
       "dbwl", ",", "wavelets", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"",
         ",", "\"\<\\\\Psi_\>\"", ",", "\"\<(x)\>\"", ",", 
        "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"texCode", " ", "=", " ", 
     RowBox[{"texCode", " ", "<>", " ", 
      RowBox[{"PWTWriteTexValidationTableV2", "[", 
       RowBox[{"dbwl", ",", 
        RowBox[{"PWTShift", "[", 
         RowBox[{"wavelets", ",", "1"}], "]"}], ",", 
        "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\Psi_\>\"", 
        ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", 
        "\"\<}(x)\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "dbsl", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"texCode", " ", "=", " ", 
         RowBox[{"texCode", " ", "<>", " ", 
          RowBox[{"PWTWriteTexValidationTableV2", "[", 
           RowBox[{
           "dbwl", ",", "dbsl", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"",
             ",", "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\"", 
            ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], 
           "]"}]}]}], ";"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "dbsr", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"texCode", " ", "=", " ", 
         RowBox[{"texCode", " ", "<>", " ", 
          RowBox[{"PWTWriteTexValidationTableV2", "[", 
           RowBox[{
           "dbwl", ",", "dbsr", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"",
             ",", "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\"",
             ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\""}], 
           "]"}]}]}], ";"}]}], "]"}]}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "dbwr", "]"}], ">", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"texCode", " ", "=", " ", 
      RowBox[{"texCode", " ", "<>", " ", 
       RowBox[{"PWTWriteTexValidationTable", "[", 
        RowBox[{
        "dbwr", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
         "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\"", ",", 
         "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"texCode", " ", "=", " ", 
      RowBox[{"texCode", " ", "<>", " ", 
       RowBox[{"PWTWriteTexValidationTableV2", "[", 
        RowBox[{
        "dbwr", ",", "basis", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", 
         ",", "\"\<\\\\varphi_\>\"", ",", "\"\<(x)\>\"", ",", 
         "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"texCode", " ", "=", " ", 
      RowBox[{"texCode", " ", "<>", " ", 
       RowBox[{"PWTWriteTexValidationTableV2", "[", 
        RowBox[{"dbwr", ",", 
         RowBox[{"PWTShift", "[", 
          RowBox[{"basis", ",", "1"}], "]"}], ",", 
         "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\varphi_\>\"",
          ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\Psi_{\\\\text{right},\>\"", 
         ",", "\"\<}(x)\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"texCode", " ", "=", " ", 
      RowBox[{"texCode", " ", "<>", " ", 
       RowBox[{"PWTWriteTexValidationTableV2", "[", 
        RowBox[{
        "dbwr", ",", "wavelets", ",", 
         "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\Psi_\>\"", 
         ",", "\"\<(x)\>\"", ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", 
         "\"\<}(x)\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"texCode", " ", "=", " ", 
      RowBox[{"texCode", " ", "<>", " ", 
       RowBox[{"PWTWriteTexValidationTableV2", "[", 
        RowBox[{"dbwr", ",", 
         RowBox[{"PWTShift", "[", 
          RowBox[{"wavelets", ",", "1"}], "]"}], ",", 
         "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", "\"\<\\\\Psi_\>\"", 
         ",", "\"\<(x-1)\>\"", ",", "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", 
         "\"\<}(x)\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dbsl", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"texCode", " ", "=", " ", 
          RowBox[{"texCode", " ", "<>", " ", 
           RowBox[{"PWTWriteTexValidationTableV2", "[", 
            RowBox[{
            "dbwr", ",", "dbsl", ",", 
             "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
             "\"\<\\\\varphi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\"", ",", 
             "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
            "]"}]}]}], ";"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dbsr", "]"}], ">", "0"}], ",", 
        RowBox[{"texCode", " ", "=", " ", 
         RowBox[{"texCode", " ", "<>", " ", 
          RowBox[{"PWTWriteTexValidationTableV2", "[", 
           RowBox[{
           "dbwr", ",", "dbsr", ",", "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"",
             ",", "\"\<\\\\varphi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\"",
             ",", "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
           "]"}]}]}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dbwl", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"texCode", " ", "=", " ", 
          RowBox[{"texCode", " ", "<>", " ", 
           RowBox[{"PWTWriteTexValidationTableV2", "[", 
            RowBox[{
            "dbwr", ",", "dbwl", ",", 
             "\"\<\\\\int_{-1}^1 f_1(x)f_2(x) dx\>\"", ",", 
             "\"\<\\\\Psi_{\\\\text{left},\>\"", ",", "\"\<}(x)\>\"", ",", 
             "\"\<\\\\Psi_{\\\\text{right},\>\"", ",", "\"\<}(x)\>\""}], 
            "]"}]}]}], ";"}]}], "]"}]}]}]}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"texCode", " ", "=", " ", 
    RowBox[{
    "texCode", " ", "<>", " ", 
     "\"\<\\\\end{landscape}\\n\\\\end{document}\\n\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"file2", " ", "=", " ", 
  RowBox[{"OpenWrite", "[", 
   RowBox[{
    RowBox[{"path", "<>", "name", "<>", "\"\<.tex\>\""}], ",", 
    RowBox[{"PageWidth", "\[Rule]", "1000"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"file2", ",", 
    RowBox[{"TextForm", "[", "texCode", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file2", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.515210707604065*^9, 3.515210969793725*^9}, {
   3.5152110052433867`*^9, 3.5152110275358257`*^9}, {3.5152110978993487`*^9, 
   3.5152111558846507`*^9}, {3.515211205795538*^9, 3.5152113067873135`*^9}, {
   3.5152113622298107`*^9, 3.515211362385811*^9}, {3.5152114271415253`*^9, 
   3.5152114901448336`*^9}, {3.515211564500963*^9, 3.515211564953364*^9}, {
   3.5152122713466682`*^9, 3.515212363181921*^9}, {3.5152123935656586`*^9, 
   3.5152123945927176`*^9}, {3.51521244200943*^9, 3.5152125829234896`*^9}, {
   3.515213109983636*^9, 3.515213131306855*^9}, {3.5152136034508605`*^9, 
   3.5152136789701796`*^9}, {3.51521374418791*^9, 3.5152137454849844`*^9}, {
   3.5152139130575686`*^9, 3.515213969673807*^9}, {3.515214004586804*^9, 
   3.515214014557374*^9}, {3.5152147120742702`*^9, 3.5152147912888007`*^9}, 
   3.5152150906259217`*^9, {3.515216263866027*^9, 3.5152163025722413`*^9}, 
   3.515216401283887*^9, {3.515219020557701*^9, 3.515219139530506*^9}, {
   3.5152191959237313`*^9, 3.515219354508802*^9}, {3.5152194133081656`*^9, 
   3.5152194662621937`*^9}, 3.5152195106087303`*^9, {3.515219543448609*^9, 
   3.51521965536701*^9}, {3.515219708678059*^9, 3.515219733945504*^9}, {
   3.5152197946369762`*^9, 3.5152198155041695`*^9}, {3.5152201383936377`*^9, 
   3.5152201993601246`*^9}, {3.5152202595615683`*^9, 3.515220269093113*^9}, {
   3.515220383133636*^9, 3.5152203932312136`*^9}, {3.515220426979144*^9, 
   3.5152205197934523`*^9}, {3.5152205750756145`*^9, 
   3.5152206324638968`*^9}, {3.5152206644717274`*^9, 
   3.5152206801016216`*^9}, {3.515220718220802*^9, 3.515220752498762*^9}, {
   3.515220797026309*^9, 3.5152208009265327`*^9}, {3.515224070287529*^9, 
   3.51522408236022*^9}, {3.5152241507901335`*^9, 3.5152241510661497`*^9}, {
   3.5152254764699583`*^9, 3.5152255704243317`*^9}, {3.515225626076515*^9, 
   3.5152256957354994`*^9}, {3.5152320579153953`*^9, 3.515232109060321*^9}, {
   3.5152321443083367`*^9, 3.5152322354845514`*^9}, {3.5152323166231923`*^9, 
   3.5152323223085175`*^9}, {3.515232371424327*^9, 3.5152326402327023`*^9}, {
   3.5152326704694314`*^9, 3.515232726063611*^9}, {3.5152327893252296`*^9, 
   3.5152327944145203`*^9}, {3.51523282464925*^9, 3.5152329579158726`*^9}, {
   3.5152330833300457`*^9, 3.5152331078644485`*^9}, {3.51523379865296*^9, 
   3.5152338009190893`*^9}, {3.515234171352277*^9, 3.5152341812688437`*^9}, {
   3.515234342465064*^9, 3.5152343467733107`*^9}, {3.5152343874766383`*^9, 
   3.515234398313258*^9}, {3.5152344362014256`*^9, 3.515234488987445*^9}, {
   3.515234612176491*^9, 3.515234669384763*^9}, {3.515234857242508*^9, 
   3.5152348862961693`*^9}, {3.5152349974045243`*^9, 3.515234997978557*^9}, {
   3.515291312033901*^9, 3.51529139838384*^9}, {3.515291431722747*^9, 
   3.515291509916219*^9}, {3.5152915417100377`*^9, 3.5152916322882185`*^9}, {
   3.5152916750826664`*^9, 3.515291772739252*^9}, {3.515291827851404*^9, 
   3.5152918680067005`*^9}, {3.5152936858696766`*^9, 
   3.5152937391707253`*^9}, {3.5152937721586123`*^9, 
   3.5152939184509797`*^9}, {3.5152939584282665`*^9, 
   3.5152939782934027`*^9}, {3.51529403384958*^9, 3.5152941341513166`*^9}, {
   3.515294284164897*^9, 3.5152942950585203`*^9}, {3.5152943380889816`*^9, 
   3.515294343522292*^9}, {3.515294530733*^9, 3.515294634141915*^9}, {
   3.515294817865423*^9, 3.515294937027239*^9}, 3.5152950080343*^9, {
   3.5152950987274876`*^9, 3.515295173683775*^9}, {3.515295223309613*^9, 
   3.515295224279669*^9}, 3.5152952549594235`*^9, {3.51529529144151*^9, 
   3.515295293330618*^9}, {3.515295444033238*^9, 3.5152954449612913`*^9}, {
   3.5152956947685795`*^9, 3.5152957024820204`*^9}, {3.515295797565459*^9, 
   3.5152959797958817`*^9}, {3.515296026597559*^9, 3.5152962252749224`*^9}, {
   3.515296316790157*^9, 3.515296317214181*^9}, {3.5152964225592065`*^9, 
   3.5152964316007233`*^9}, {3.5153002134500327`*^9, 3.515300285520155*^9}, {
   3.5153003870539627`*^9, 3.5153003913542085`*^9}, {3.5153050768162017`*^9, 
   3.515305490831882*^9}, {3.5153057472195463`*^9, 3.5153059145561175`*^9}, 
   3.5153059471259804`*^9, {3.5153060687389364`*^9, 3.5153060773414288`*^9}, {
   3.5153068862376947`*^9, 3.515306904229724*^9}, {3.515310442622108*^9, 
   3.5153104523846664`*^9}, {3.5153105437758937`*^9, 
   3.5153105504962783`*^9}, {3.51531188871482*^9, 3.515311896320255*^9}, 
   3.5153127802388124`*^9, {3.5153128879109707`*^9, 3.5153130053816895`*^9}, {
   3.5153790660153427`*^9, 3.5153791127030125`*^9}, {3.515379149257104*^9, 
   3.5153793316115336`*^9}, {3.515379501178232*^9, 3.515379704312851*^9}, {
   3.5153803830246716`*^9, 3.515380386587875*^9}, {3.515381165003398*^9, 
   3.5153812732405887`*^9}, {3.5153814413092017`*^9, 3.515381455957039*^9}, {
   3.5153870346761236`*^9, 3.51538703478413*^9}, {3.515390485135479*^9, 
   3.5153905525663357`*^9}, {3.515390605760378*^9, 3.5153907527667866`*^9}, {
   3.515396683386998*^9, 3.515396683484004*^9}, {3.5227396387548237`*^9, 
   3.522739653803936*^9}, 3.52283623887437*^9}]
}, Open  ]]
},
WindowSize->{1280, 1002},
WindowMargins->{{196, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 153, 2, 67, "Section"],
Cell[723, 26, 202, 4, 26, "Text"],
Cell[928, 32, 44297, 1127, 1183, "Input"],
Cell[45228, 1161, 303, 6, 56, "Text"],
Cell[45534, 1169, 115556, 2852, 3853, "Input"],
Cell[161093, 4023, 145, 2, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161275, 4030, 99, 1, 67, "Section"],
Cell[161377, 4033, 14736, 402, 388, "Input"],
Cell[176116, 4437, 2579, 62, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178732, 4504, 105, 1, 67, "Section"],
Cell[178840, 4507, 6358, 172, 238, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185235, 4684, 352, 12, 67, "Section"],
Cell[185590, 4698, 8710, 224, 283, "Input"],
Cell[194303, 4924, 448, 9, 27, "Input"],
Cell[194754, 4935, 1723, 50, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196514, 4990, 159, 2, 67, "Section"],
Cell[196676, 4994, 2156, 62, 103, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198869, 5061, 105, 1, 67, "Section"],
Cell[198977, 5064, 8224, 205, 283, "Input"],
Cell[207204, 5271, 4594, 139, 268, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211835, 5415, 177, 2, 67, "Section"],
Cell[212015, 5419, 2849, 77, 118, "Input"],
Cell[214867, 5498, 737, 21, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215641, 5524, 97, 1, 67, "Section"],
Cell[215741, 5527, 7021, 160, 268, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222799, 5692, 99, 1, 67, "Section"],
Cell[222901, 5695, 28130, 591, 1358, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
